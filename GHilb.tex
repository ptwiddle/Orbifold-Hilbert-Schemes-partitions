\documentclass{amsart}[12pt]
%\pdfoutput=1



\usepackage{tikz}
\usetikzlibrary{arrows, snakes} %for arrowtips  
\usepackage[sc]{mathpazo}
\usepackage{hyperref}
\usepackage{microtype}
\usepackage{tikz}
\usepackage{graphicx}
\usepackage{wrapfig}
%\usepackage{mathtools} %for \mathclap, fixing long subscripts in a summation
\linespread{1.2}
\usepackage{xcolor}
\hypersetup{
    colorlinks,
    linkcolor={red!80!black},
    citecolor={blue!80!black},
    urlcolor={blue!80!black}
}


\theoremstyle{definition}

\newtheorem*{theorem*}{Theorem}
\newtheorem{dummy}{}[section]
\newtheorem{theorem}[dummy]{Theorem}
\newtheorem{lemma}[dummy]{Lemma}
\newtheorem{example}[dummy]{Example}
\newtheorem{corollary}[dummy]{Corollary}
v\newtheorem{definition}[dummy]{Definition}
\newtheorem{remark}[dummy]{Remark}
\newtheorem{proposition}[dummy]{Proposition}
\newtheorem{observation}{Observation}
\newtheorem{question}{Question}
\newtheorem{conjecture}[dummy]{Conjecture}
\newtheorem{warning}[dummy]{Warning}

\newcommand{\Z}{\mathbf{Z}}
v\newcommand{\C}{\mathbf{C}}
\newcommand{\N}{\mathbf{N}}
\newcommand{\R}{\mathbf{R}}
\newcommand{\Q}{\mathbf{Q}}
\newcommand{\A}{\mathbf{A}}
\newcommand{\OO}{\mathcal{O}}
\newcommand{\LL}{\mathbf{L}}
\newcommand{\PP}{\mathcal{P}} % partitions
\newcommand{\II}{\mathcal{I}}
\newcommand{\Reg}{\mathbf{G}}

\newcommand{\coleg}{\text{co}\ell}


\newcommand{\proj}{\mathbf{P}}
\newcommand{\core}{\mathbf{core}}
\newcommand{\quot}{\mathbf{quot}}
\newcommand{\irreps}{\text{irreps}}
\newcommand{\Var}{\mathbf{Var}}
\newcommand{\Top}{\mathbf{Top}}
\newcommand{\Sur}{\mathcal{S}}


\DeclareMathOperator{\dusty}{pdim}
\DeclareMathOperator{\Hilb}{Hilb}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\DC}{DH}
\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\Ker}{Ker}
\DeclareMathOperator{\cdim}{cdim}


\newcommand{\HG}{\Hilb}
\newcommand{\Gcomb}{\mathcal{GC}}

\begin{document}



\begin{abstract}
We study the connection between the combinatoric of certain partition statistics and the topology of the Hilbert schemes of certain orbifold surfaces.
\end{abstract}


\title{Orbifold Hilbert schemes and a generalization of cores and quotients}


\author{Paul Johnson}
\address{University of Sheffield}
\email{paul.johnson@sheffield.ac.uk}


\maketitle
\setcounter{tocdepth}{1}
\tableofcontents
This paper is written for two largely distinct audiences: algebraic geometers interested in Hilbert schemes of points and orbifold surfaces, and combinatorialists studying partitions -- particularly the construction of cores and quotients.  As such, there is more expository material than perhaps is standard.  In particular, we have two introductions, one for geometers, and one for combinatorialists.


\section{Introduction for Geometers}
From the geometric point of view, this paper studies the topology of Hilbert schemes of points on $\C^2/G$, where $G$ is an abelian group.  

Our motivation is the structure found in the topology of Hilbert schemes of point on a smooth surface $S$.G\"ottsche, building on the work of Ellingsrud and Str\o me for $\C^2$, found product formulas for generating functions of their cohomology, which implied a stabilization result on their homology.  Later, Grojnowski and Nakajima \cite{grojnowski, nakajimaheisenberg} explained these product formulas using geometric representation theory.  This background is discussed at length in Section \ref{sec:smoothbackground.}

With the philosophy that, viewed as stacks, orbifolds should be behave just as well as smooth surfaces, it is a natural question to ask whether similar structure is found in the topology of Hilbert schemes on orbifold surfaces.  One then is lead to first start with the local models $[\C^2/G]$.  When $G$ is abelian, the techniques of Ellingsrud and Str\o mme adapt to give a combinatorial recipe for computing $H_k(\Hilb_n([\C^2/G]))$ in terms of the partitions of $n$.

This direction was taken by Gusein-Zade, Luengo, and Melle-Hern\'andez in \cite{GLM}, which we refer to as GLMZH from here.  In particular, they conjecture:

\begin{conjecture}{Gusein-Zade, Luengo, Melle-Hern\'andez}
Let $\Z/3\Z$ act on $\C^2$ diagonally.  Then
\begin{equation*}
\begin{split}
\sum_{k, n\geq 0} h_k(\Hilb_n([\C^2/\Z/3\Z]))q^nt^k =&\frac{1}{(1-q)}
\frac{1}{(1-t^2q^2)}\frac{1}{(1-q^3)} \cdot \\
&\frac{1}{(1-t^2q^4)}\frac{1}{(1-t^4q^5)}\frac{1}{(1-t^2q^6)}\cdot \\
&\frac{1}{(1-t^4q^7)}\frac{1}{(1-t^6q^8)}\frac{1}{(1-t^4q^9)}\cdots
\end{split}
\end{equation*}
\end{conjecture}

The right hand side is a $t$-analog of the Euler product, where the power of $t$ that is attached to $q^n$ is roughly $n/3$, with the some rounding up or down depending on the residue of $n$ mod 3.

It is implicit GZLMH that similar formulas should hold for any cyclic group $G$, but no explicit conjecture that holds for all $G$ was made.  Our first new contribution is to remedy this; we give an explicit product formula for.  Fittingly, our formula can be interpretted as being analogous to G\"ottsche's formula, but involving the Chen-Ruan cohomology of $[\C^2/G]$.

These product formulas are inadequate for fully understanding the topology of $\Hilb_n([\C^2/G])$.  When $X$ is a smooth surface, $\Hilb_n(X)$ is connected; however, $\Hilb_n([\C^2/G])$ is usually \emph{not} connected.  The tautological bundle $\C[x,y]/\II$ over a point $\II\subset\Hilb_n([\C^2/G])$ is a $n$-dimensional represention of $G$, and so its class in $K^0(G)$ is a discrete invariant.

For $v$ an $n$-dimensional representation of $G$, denote by $\Hilb_v([\C^2/G])\subset \Hilb_n([\C^2/G])$ the locus of ideals with $\C[x,y]/\II\cong v$ as $G$-representations.  Generalizing Evain \cite{evain1}, Maclaglan and Smith showed that $\Hilb_v([\C^2/G])$ is connected \cite{MS}.

We show in Proposition \ref{prop:connected} that in the cases we consider, $\Hilb_v([\C^2/G])$ are connected.  

In this point of view, the regular representation of $G$, which we will denote $R$, plays a special role.  Adding a smooth point of $[\C^2/G]$ corresponds to adding a copy of the regular representation.  Furthermore, for some representations $v$, the ideals in $\Hilb_v([\C^2/G])$ will be supported only over the singular points in $\C^2/G$.  For instance, $\Hilb_1([\C^2/G])$ will always be isomorphic to the $G$ fixed locus $(\C^2)^G$.

It dependence of $\Hilb_v([\C^2/G])$ on $v$ behaves very differently in the direction of the regular representation and the other directions.  In the direction of the regular representation, we prove:

\begin{theorem}
Let $v\in K^0(G)$ be arbitrary.  As $n\to \infty$, and $k$ fixed, the homology $h_k(\Hilb_{v+nR}([\C^2/\mathbb{Z}/r\mathbb{Z}]))$ stabilizes.  The generating function of the stable homology is
$$\prod_{m\geq 1} \frac{1}{(1-t^{2m})^{|r|}}$$
\end{theorem}

The proof is combinatorial, involving a generalization of the classical notion of ``cores and quotients'' of partitions.  A conjectural topological interpretation of the product formula is that all the cohomology of $\Hilb_v$ is \emph{tautological}, and that in the stable limit there are no relations among the tautological generators.


\begin{conjecture}
Let $v$ be any representation so that $\Hilb_v([\C^2/\Z_r])$ is concentrated over the origin.  Then the cohomology

$$\bigoplus_{m\geq 0} \Hilb_{v+mR} $$ 

carries an action of the Heisenberg algebra modeled on the cohomology of the minimal resolution of $\C^2/\Z_r$; it is an infinite sum of highest weight representations.
\end{conjecture}

\subsection{Piecewise quadratic behavior of ``small'' representations}


\begin{theorem}
For every class in $\overline{v}\in K^0(G)/R$ there is a unique representative $\tilde{v}\in K^0(G)$, so that $\Hilb_{\tilde{v}}([\C^2/\Z_r])$ is small.  

We have that $\dim \tilde{v}$ and $\dim \Hilb_{\tilde{v}}([\C^2/\Z_r])$ are piecewise quadratic functions on $K^0(G)/R$.
\end{theorem}

The geometric meaning or origin of $\dim \tilde{v}$ is piecewise quadratic is not clear to us; the proof and motivation for stating this theorem are both combinatorial.  That $\dim \Hilb_{\tilde{v}}$ is piecewise quadratic follows from Riemann-Roch and the fact that $\dim \tilde{v}$ is.    


We believe the quadratic part to be related to the intersection pairing of the minimal resolution of $\C^2/\Z_r$, and speculate that the piecewise behavior is related to stability conditions for the McKay quiver.




\section{Introduction for combinatorialists}
In this work, we introduce and study a generalization of cores and quotients of partitions.  Cores and quotients of partitions initially arose in the study of the modular representation theory of the symmetric group, but have found wider roles in combinatorics, number theory and representation theory, among others.  A lesser known occurence is in the geometry of Hilbert schemes of points on orbifolds; it is this occurence that leads to our generalization.  

\subsection{}
A partition is of $n$ is a nondincreasing sequence of numbers $\lambda_1\geq \lambda_2\geq \cdots \geq \lambda_\ell > 0$ with $\sum \lambda_i=n$  The \emph{length} $\ell(\lambda)$ of a partition is the number of parts, the \emph{size} $|\lambda|$ is the sum of the parts.  We use $\PP$ to denote the set of all partitions, and $\PP_n$ to denote the partitions of $n$.

Rather than a list of numbers, we usually view a partition as being equivalent to its \emph{Young diagrams}.  We draw our Young diagrams as subsets of a grid in the first quadrant, with the square in the corner being $(0,0)$, and with the columns being the parts of $\lambda$.

We write $\square\in\lambda$ to mean a cell contained in the $\lambda$.  The \emph{arm} $a(\square)$ of a square $\square\in\lambda$ is the number of cells above $\square$ and in $\lambda$; the \emph{leg} $\ell(\square)$ of a cell is the number of cells contained in $\lambda$ and to the right of $\square$.  We will occasionally need to refer to the \emph{coarm} and \emph{coleg} of a square, which we will denote $a^\prime(\square)$ and $\ell^\prime(\square)$, and which refer to the number of cells contained in $\lambda$ and below and to the left of $\square$, respectively. 

\begin{example}
Below is the Young diagram of $\lambda=4+4+3+2+2+2$.  The cell $(3,1)$ is marked $s$; the cells in the arm and leg of $s$ are labeled $a$ and $l$, respectively, and the cells in the coarm and coleg of $s$ are labeled $ca$ and $cl$, respectively/
\begin{center}
\begin{tikzpicture}[scale=.5]
\draw[thin, gray] (0,0) grid (2,4);
\draw[thin, gray] (0,0) grid (3,3);
\draw[thin, gray] (1,0) grid (6,2);

\draw[thick] (0,0)--(0,4)--(2,4)--(2,3)--(3,3)--(3,2)--(6,2)--(6,0)--cycle;
\draw (2.5,1.5) node{$s$};
\draw (2.5,2.5) node{$a$};
\draw (3.5,1.5) node{$l$};
\draw (4.5,1.5) node {$l$};
\draw (5.5,1.5) node {$l$};


\draw (0.5,1.5) node {$cl$};
\draw (1.5,1.5) node {$cl$};
\draw (2.5,0.5) node {$ca$};


\draw (10,2) node[align=left] {$a(s)=\# a=1$ \\ $\ell(s)=\# l=3$ \\ $a^\prime(s)=\# ca=1$ \\ $\ell^\prime(s)=\# cl=2$};
\end{tikzpicture}
\end{center}
\end{example}


Recall that the \emph{hook length} $h(\square)=a(\square)+\ell(\square)+1$.  Define $h_r(\lambda)$ to be the number of $\square\in\lambda$ with hooklength $h(\square)$ divisible by $r$.  Partitions with $h_r(\lambda)=0$ are called $r$-cores.  The classical notion of cores and quotients proves the following product formula

\[\sum_{\lambda\in\PP} q^{|\lambda|}t^{h_r(\lambda)}=\prod_{m\geq 1} \frac{(1-q^{rm})^r}{(1-q^m)}\prod_{m\geq 1}\frac{1}{(1-q^{rm}t^m)^r}\]
The first product here is the generating function for $r$-cores, and the second product is a generating function for $r$-quotients; $h_r(\lambda)$ is the size of the $r$-quotient of $\lambda$.  

\begin{conjecture}
  The generating function
  \[ \Gcomb_{k/r}(q,t)=\sum_{\lambda\in\PP}q^{|\lambda|}t^{\cdim^+_{k/r}(\lambda)}\]
has a product formula that is a $t$ analog of the Euler product when $(k+1,r)=1$, and of the $s$-cores and quotient product when $(k+1,r)=s$.
\end{conjecture}

The precise form of this conjecture, and a geometric interpretation of it, is given in.  

For $k, r$ integers, we define
\[\cdim^+_{k/r}(\lambda)=\#\left\{\square\in\lambda \Big | \ell(\square)-k a(\square)=-1 \pmod r\right\}. \]
We see this family of statistics is related to cores and quotients because $h_r(\lambda)=\cdim^+{-1/r}(\lambda)$.


\subsection{Quadratic forms}
Another part of the cores and quotients story is that $r$-core partitions are in bijection with a lattice $\Z^{r-1}$, so that the size $|\lambda|$ of a given $r$ core becomes a quadratic function on the lattice.




Using this geometry as motivation, we introduce here some new partitions statistics, and use a generalization of cores and quotients of partitions to study them.  Our first statistic turns out out to be the size of our generalized quotient, and it counts cells where certain linear combinations of the arm and leg lengths satisfy a congruence condition.  We conjecture that $(q,t)$ counting partitions with respsect to size and this new statistic satisfy explicit product formulas that are $t$-analogs of the Euler product (or more generally, $t$-analogs of the formula for partitions coming from cores and quotients).  



We prove that ``$G$-core'' partitions are in bijection with lattice points, and their size is given by a piecewise quadratic function.  




Buryak conjectured \cite{Buryak}, and later proved with Feigin \cite{BF}, and simplified the proof with Nakajima \cite{BFN}, the following version. 

\begin{theorem}[Buryak-Feigin-Nakajima] \label{thm:BFN}
Let $\C^*$ act on $\C^2$ by $t\cdot (x,y)=(t^ax, t^by), a,b\geq 0$.  Then

$$\sum_{k,n} h^k(\Hilb_n(\C^2)^{\C^*})q^nt^k=\prod_{a+b } \frac{1}{1-q^\ell}\prod_{(a+b)|\ell} \frac{1}{1-q^\ell t}$$
\end{theorem}

The proofs given by Buryak-Feigin, and Buryak-Feigin-Nakajima are algebraic geometric, and go through quiver varieties.  An obvious first step in trying to prove our conjectures combinatorially would be to prove Theorem \ref{thm:BFN} combinatorially.  





\subsection{Acknowledgements}

Research on this work was supported by NSF grant NUMBER HERE, and CITE TOM's GRANT?

Thanks to Amin Gholampour, Yunfeng Jiang, and Martijn Kool for asking a question that began this work, and to Tom Bridgeland for useful conversations.

\section{Background: Partitions}


\subsection{Partitions}


The other combinatorial lens we will use to view partitions is the fermionic viewpoint, so named in .  

The boundary path is the directed lattice path starting at postive infinity on the $y$ axis, descending along the $y$ axis, tracing the boundary of $\lambda$, and then going along the $x$-axis to positive infinity.  One way to view this is as a bi-infinte word consisting of the letters $S$s and $E$; we will use the \emph{Maya diagram}, this is, on the simplest level, just translating $S$'s into empty circles, and the $E$'s into filled in circles, or stones.  



The cells $\square\in\lambda$ are in bijection with the
\emph{inversions} of the boundary path; that is, by pairs of segments
$(\text{step}_1, \text{step}_2)$, where $\text{step}_1$ occurs before $\text{step}_2$, but $\text{step}_1$ is traveling E and $\text{step}_2$ is traveing S.  The bijection sends $\square$ to the segments at the end of its arm and leg.





\section{Background: Hilbert schemes of points on smooth surfaces}
\label{sec:smoothbackground}



\subsection{Introduction to Hilbert schemes}

Throughout, $R=\C[x,y]$ will be the polynomial ring in two variables.  

The Hilbert scheme of points in the plane parameterizes ideals $\II$ of $R$ of codimension $n$:
$$\Hilb_n(\C^2)=\{\II\subset R | \dim_\C R/\II=n\}$$
The space $\Hilb_n(\C^2)$ is smooth and connected of dimension $2n$.

Geometrically, $\Hilb_n(\C^2)$ should is a resolution of the set of $n$ points in the plane, as we now describe.

 We write $\Sym^n(\C^2)=(\C^2)^n/S_n$ for the set of $n$ unordered points in $\C^2$.  The space $\Sym^n(\C^2)$ is singular for $n>1$, with singularities occuring where the points are not unique, as $S_n$ does not act freely here.  

Let $P=\{p_1,p_2,\dots, p_n\}$ be a set of $n$ distinct points in the plane, and hence a smooth point point of $\Sym^n(\C^2)$.  

Given $P$, we can also form the ideal $\II_P$ of polynomials vanishing on $P$:
 $$\II_{P}=\{f\in R| f(p)=0 \text{ for }p\in \mathbf{p}\},$$  
this is a point of $\Hilb_n(\C^2)$.  Thus, there is a locus in $\Hilb_n(\C^2)$ that agrees with the smooth locus of $\Sym^n(\C^2)$. 

 If two of the points collide, there is still a limiting ideal $\II$.  This ideal has some non-reduced structure that ``remembers how the points collided''.  This is best illustrated with an example.


\begin{example} \label{ex:twopoints}
Let $(a,b)\neq (0,0)\in\C^2$, and let $P_t$ be the pair of distinct points $(0,0)$ and $(at,bt)$.  What is the limit $\II_{P_0}$ of $\II_{P_t}$ as $t\to 0$?

The ideal $\II_{P_t}$ can be written as follows: 
$$(\{x,y\})(\{x-at,y-bt\})=(\{x(x-at),x(y-bt), y(x-at), y(y-bt)\}$$
Setting $t=0$, we see that $\II_{P_0}$ should contain $x^2, xy$ and $y^2$.  Since $(x^2,xy,y^2)$ has codimension three instead of two, $\II_{P_0}$ must contain a linear term.

Taking the difference of the the middle two generators of $\II_{P_t}$, we see that it contains $btx-aty$. As $\II_{P_t}$ is an ideal and $t$ is a nonzero scalar, it must contain $bx-ay$.  Now as $bx-ay\in \II_{P_t}$ for $t\neq 0$, it certainly should be contained in the limit as well.  

Let $v=(a,b)\in T_0\C^2$ be the direction the two points collided in.  Then another way to describe $\II_{P_0}$ is as $\II_v$, where
$$\II_{v}=\{f\in R| f(0)=\partial_vf(0)=0\}$$
This is what we mean when we say the non-reduced scheme structure at $\II_{P_0}$ \emph{remembers} the direction the in which the points collided. 
\end{example}

We have seen that $\Hilb_n(\C^2)$ and $\Sym^n(\C^2)$ agree for the smooth locus of $\Sym^n(\C^2)$, but that $\Hilb_n(\C^2)$ is larger over the singular locus of $\Sym^n(\C^2)$, where the points are not distinct.  It turns out that $\Hilb_n(\C^2)$ is smooth, and a resolution of singularities of $\Sym^n(\C^2)$; the resolution map is the Hilbert-Chow morphism:

\begin{definition}
The \emph{Hilbert-Chow morphism} $HC:\Hilb_n(S)\to\Sym^n(S)$ sends an ideal $\II$ to the support of $R/\II$, weighted by its multiplicity
$$HC:\II\mapsto \sum_{p\in S} \dim_p (R/\II)$$
\end{definition}









\subsection{Topology of Hilbert schemes}


We now summarize the results on the Hilbert schemes of smooth surfaces that motivate our conjecture.  A key point is that this structure is simpler to state when looking at the Hilbert schemes together for all $n$, rather than just for any fixed $n$.  

\begin{definition}
A \emph{graded space} $X$ is a disjoint union $$X=\coprod_{n=0}^\infty X_n$$
We will be lazy and write graded spaces as formal power series with coefficients in $\Var, \Top$, etc.
$$X=\sum_{n=0}^\infty X_nq^n$$
\end{definition}

The Hilbert schemes of points on a surface $S$ naturally form a graded space.

\begin{definition}
Let $S$ be a smooth surface.  We define:
$$\HG_S=\sum_{n=0}^\infty \Hilb_n(S)q^n$$
\end{definition}

\begin{definition}
Recall that for a space $X$, the Poincare polynomial $P_t(X)$ is the generating series of its Betti numbers:
$$P_t(X)=\sum_{k=0}^\infty b_k(X)$$
If $X$ is a graded space with finite dimensional graded pieces, then $P_t(X)$ is naturally an element of $\Z[t][[q]]$.
\end{definition}
 
Though for familiarity we will work with cohomology, most of our work could be done in the Grothendieck ring of varieties.

\begin{definition}
The \emph{Grothendieck ring of varieties} $K_0(\Var_k)$ is a quotient of the free abelian group on the set of isomorphism classes of varities over $k$.  We quotient out by relations of the form
$$[X]=[Y]+[X\setminus Y]$$
whenever $Y$ is a closed subvariety of $X$.   

The product structure is given by
$$[X]\times [Y]=[X\times Y]$$

Again, if $X$ is a graded space with positively graded pieces, then $[X]$ will be an element of $K_0(\Var_k)[[q]]$.

In $K_0(\Var_k)$, affine spaces are denoted $\LL^k=[\C^k]$.

\end{definition}

Before we turn to Hilbert schemes, we illustrate the use of graded spaces and the idea that the topology is simpler when considering all $n$ at once in the simple case of projective spaces.


\begin{example}[Projective space]
The fact that the Riemann sphere is obtained from $\C$ by adding a point at infinity translates to the identity $[\proj^1]=\LL+1$.

More generally, the decomposition $\proj^n=\C^n\amalg \proj^{n-1}$ gives
$$[\proj^n]=\LL^n+[\proj^{n-1}]=\LL^n+\LL^{n-1}+\cdots 1=\frac{1-\LL^{n+1}}{1-\LL}$$


We now put all projective spaces together into a graded space 
$$\proj=\sum_{n\geq 0} \proj^nq^n$$ 
A short computation with the previous line gives
$$[\proj]=\frac{1}{(1-q)(1-q\LL)}$$

\end{example}


The study of the topology of $\Hilb_n(S)$ began with the following result of Ellingsrud and Str\o mme:
\begin{theorem}[Ellingsrud and Str\o mme \cite{ES}] \label{thm:ES}

$$P_t(\HG_{\C^2})=\prod_{\ell=1}^\infty \frac{1}{1-t^{2\ell-2}q^\ell}$$
$$[\HG_{\C^2}]=\prod_{\ell=1}^\infty \frac{1}{1-\LL^{\ell +1}q^\ell}$$
\end{theorem}

Building on this, we have:

\begin{theorem}[G\"ottsche, \cite{gottsche}] \label{thm:gprod}
Let $S$ be a smooth quasiprojective surface, and let $b_i$ denote $b_i(S)$.  Then:
$$P_t(\HG_S)=\prod_{\ell\geq 1} \frac{(1+t^{2\ell-1}q^\ell)^{b_1}(1+t^{2\ell+1}q^\ell)^{b_3}}{(1-t^{2\ell-2}q^\ell)^{b_0}(1-t^{2\ell}q^\ell)^{b_2}(1-t^{2\ell+2}q^\ell)^{b_4}}$$
\end{theorem}

When $S=\C^2$, G\"ottsche's theorem reduces to Ellingsrud-Str\o mme's result.  G\"ottsche's original proof used the Weil conjectures to reduce to the local model of the smooth surfaces, $S=\C^2$.  

Our first conjecture is an analog of Theorem \ref{thm:gprod} for $S=[\C^2/G]$; our main theorem is an analog of the following corollary to G\"ottsche's formula:

\begin{corollary} \label{cor:gstab} Suppose further that $S$ is connected.
Then for fixed $k$ and large $n$, $b_{k}(\Hilb_n(S))$ stabilizes.
\end{corollary}

\begin{proof}
The point is that there is exactly one factor in the product formula that has no $t$'s, namely $1/(1-q)^{b_0}$.  When $S$ is connected, $b_0=1$.  If we remove this term, we may expand the rest of the product as a series \emph{in $t$}, and the coefficient of $t^k$ will be a polynomial $p_k(q)$ in $q$.  

Adding the $1/(1-q)$ term back in means that once a monomial $q^kt^m$ occurs, it will now also occur for all higher powers of $k$.  Hence, we see that once $n\geq\text{deg}(p_k)$, we will have $b_k(\Hilb_n(S))=p_k(1)$.
\end{proof}

Our third conjecture is an analog of the work of Grojnowski and Nakajima \cite{grojnowski, nakajimaheisenberg}. who reproved Theorem \ref{thm-gprod} by categorifying it.  They observed that power series on the right hand side of Theorem \ref{thm-gprod} is the $(q,t)$ character of the highest weight representation of the Heisenberg algebra generated by $H^*(S)$.  This lead them to hope that the vector space 
$$H^*(\HG_S)=\bigoplus_{\substack{n\geq 0 \\ k\geq 0}} H^k(\Hilb_n(S))$$
has a natural action of this Heisenberg algebra.  This is exactly what Grojnowski and Nakajima did, using nested Hilbert schemes of points.  

\begin{theorem} \label{thm:grojnowskinakajima}
$H^*(\HG_S)$ is an irreducible heighest weight representation of the Heisenberg algebra generated by $H^*(S)$.
  \end{theorem}

Moreover, in case the quasiprojective surface $S$ is the minimal resolution of the ADE singularity, this Heisenberg action is part of a quantumn group action for the corresponding semisimple quantum group.

Further categorifications and extensions of this Heisenberg action are an area of active study, see e.g. \cite{CL, CL2, FT, SV}.







\section{Hilbert schemes of points on orbifolds}


We will now introduce notation for the group actions we are interested in.  In principle, one can study $\Hilb_n([\C^2/G])$ for any $G$.  The localization techniques that reduce their topology to the study of partitions requires that $G$ be abelian.  The case of $\C^*$ has been studied by Buryak, Feigin, and Nakajima, so in this paper we focus on finite abelian groups.  From both the geometric and combinatorial perspective, groups with isolated fixed points -- i.e., groups that fix only the origin, and not all of $\C^2$ or a line in $\C^2$, behave better and are more interesting.  The only abelian groups that act with an isolated fixed point are cyclic.

Thus, let $\Z_r$ act on $\C^2$, and let $g\in\Z_r$ be a generator.   We can choose coordinates so that this action is diagonal, and hence $g\cdot (x,y)=(\zeta^a x, \zeta^by)$.  We will denote this group action by $\frac{1}{r}(a, b)$.  

Since the action has isolated fixed points, we can find a generator $h\in\Z_r$ so that $h\cdot (x,y)=(\zeta x, \zeta^by)$; we will sometimes use $a/r$ to refer to this group. Switching the roles of $x$ and $y$, we see that that if $bc=1\in\Z_r$, then $b/r$ is equivalent to $c/r$.

For $G$ any finite group acting on $\C^2$, we will write $\Sur_G$ to denote the stack $[\C^2/G]$. Let $G$ be the group $\mathbb{Z}/r\mathbb{Z}$, acting with weights $1/k, k/r$, with $k$ relatively prime to $r$.  Any cyclic group acting on $\C^2$ so that only the origin has a nontrivial stabilizer will be of this form after changing coordinates on $\mathbb{C}^2$ and changing generator of $\mathbb{Z}/r\mathbb{Z}$.  We will write $\Sur_{k/r}$ to denote $\Sur_G$ in this case.




\subsection{Orbifolds and stacks}
We turn now to Hilbert schemes on orbifolds.  From a naive perspective, an orbifold is a space where every point has a neighborhood isomorphic to $\C^n/G$, where $G$ is a finite group.  An object on the local chart $\C^n/G$ is a $G$-invariant object on $\C^n$: for example, a map to $\C^n/G$ is a $G$ invariant map to $\C^n$, and a sheaf on $\C^n/G$ is a $G$-invariant sheaf on $\C^n$.  Viewed in this way, orbifolds are mildly singular spaces, with the singularities the points where $G$ does not act freely.

An alternate point of view is to enlarge our category and view orbifolds as stacks with finite stabilizers.  We will use brackets $[\C^n/G]$, or calligraphic letters $\mathcal{X}$ to denote that we are working with a stack rather than a variety.  

Stacks have a reputation for being technically formidable, but we will not need much stack machinery -- just the naive point of $[\C^n/G]$ is something so that objects on $[\C^n/G]$ are $G$-\emph{equivariant} objects on $\C^n$.  


One benefit of the stacky point of view is that $[\C^n/G]$ is a smooth object in the category of stacks, and the idea that theorems for smooth spaces should have analogs for smooth stacks.


\subsection{Orbifold Hilbert schemes}

With the above point of view, the Hilbert scheme of $n$ points on $[\C^2/G]$ should parameterize $G$-equivariant ideals of $R$.  Since $R$ has an action of $G$, and ideals are subsets of $R$, the $G$ action on an ideal is forced upon us, and $G$-equivariant ideals are just $G$-invariant ideals.  Thus, the Hilbert scheme of $n$ points on $[\C^2/G]$ is just the $G$-fixed locus of the Hilbert scheme of $n$ points on $\C^2$.

\begin{definition}
$$\Hilb_n([\C^2/G])=\Hilb_n(\C^2)^G$$
\end{definition}

\begin{remark}
This is potentially confusing, given the discussion in the previous section that passing from the singular space $\C^2/G$ to the smooth stack $[\C^2/G]$ is done by replacing $G$-invariant objects with $G$-equivariant objects.  It is therefore worth mentioning that the Hilbert scheme of $n$-points on the singular space $\C^2/G$ is the space of ideals in the ring of invariants $R^G$:
$$\Hilb_n(\C^2/G)=\{\II\subset R^G | \dim R^G/\II=n\}$$
\end{remark}

Viewing $\Hilb_n([\C^2/G])$ as the fixed point set of the $G$ action on $\C^2$ is much simpler than the stack theoretic viewpoint, and will be our main way of working with the Hilbert schemes.  However, we will continue to write $\Hilb_n([\C^2/G])$ instead of $\Hilb_n(\C^2)^G$ because our motivation comes from the philosophy that results for smooth spaces should extend to smooth stacks.

We also highlight that $\Hilb_n([\C^2/G])$ is a space and not a stack, even though $\C^2/G$ is a stack.  In fact, we have the following:

\begin{lemma} For any $n$ and $G$, $\Hilb_n([\C^2/G])$ is smooth.
\end{lemma}

\begin{proof}  
  We have $\Hilb_n([\C^2/G])=\Hilb_n(\C^2)^G$ is the fixed point set of a group acting on a smooth space, and hence smooth.
  \end{proof}

To build intuition, we now look at $\Hilb_n([\C^2/G])$ when $n$ is one or two.

\begin{example}
Let $X$ be any variety.  Then $\Hilb_1([X/G])=\Hilb_1(X)^G$, and since $\Hilb_1(X)=X$, we see this that $\Hilb_1([X/G])=X^G$, the fixed point set of $G$ acting on $X$.  In particular, we have that $\Hilb_1(\Sur_{k/r})$ is a point.
\end{example}

Note this behaviour is very different than Hilbert schemes on spaces, where $\Hilb_1(X)=X$, and suggests that for orbifolds, it is wrong to think of $n$ as counting the number of points.

\begin{example} \label{ex:twopointsorbifold}
We now look at $\Hilb_2(\Sur_{k/r})$.  

First, consider the $G$ action on the locus of $\Hilb_2(\C^2)$ consisting of two distinct points $\{p, q\}$.  To be $G$-invariant, we need this set of points to be a union of $G$-orbits.   As only the origin has nontrivial stabilizer, every $G$-orbit on $\C^2$ is either the origin, consisting of one point, or consits of $|G|=r$ distinct points.  So, if $r>2$, there are no points in $\Hilb_2(\C^2)^G$ consisting of distinct points.  

If $r=2$, we must have $k=1$, the nontrivial element of $G=\Z/2\Z$ acts as multiplication by -1. Then the points of $\Hilb_2(\C^2)^G$ consisting of distinct points of $\C^2$ are precisely those of the form $\{p,-p\}$.  These are the free orbits of $\Z_2$ on $\C^2$, and so we see the locus in $\Hilb_2(\C^2)^G$ consisting of distinct points is isomorphic to the smooth part of $\C^2/\Z_2$.


Now consider the action on the locus where the two points have collided -- that is, the ideal is supported at one point $p$.  For the ideal to be $G$ invariant, this point needs to be $G$-fixed, and so we must have $p=(0,0)$.  Thus, we are considering ideals of the form $\II_{0, v}$ for $v\in T_{0,0}C^2$ from Example \ref{ex:twopoints}.  For $\II_{v}$ to be $G$ invariant, we must have that $v$ is an eigenvector for the $G$ action.

When $k=1$, the $G$ action is diagonal, and so every tangent vector $v$ is an eigenvector.  Thus, in this case there is a $\proj^1$ worth of points over the origin.  If $r>2$, these are the only points, and so we have $\Hilb_2(\Sur_{1/r})=\proj^1$.  If $r=2$, then we see $\Hilb_2(\Sur_{1/2})$ is isomorphic to $\C^2/\Z_r$ away from the origin, but is smooth and replaces the singular point of $\C^2/\Z_2$ with a $\proj^1$ -- that is, it is a resolution of $\C^2/Z_2$.

Finally, in the case that $k> 1$, a generator $g\in\Z_r$ acts on $\C^2$ as $(\zeta, \zeta^k)$, and we see there are two distinct eigenvectors $(1,0)$ and $(0,1)$.  Thus, when $k>1$ we see that $\Hilb_2(\mathcal{S}_{k/r})$ consists of two points.

\end{example}


\subsection{Connected components of $\Hilb_n(\Sur_{k/r})$}
Example \ref{ex:twopointsorbifold} shows that, in contrast to Hilbert schemes of smooth surfaces, Hilbert schemes of stacks need not be connected.   There is an obvious discrete invariant that explains this.

 Since $R$ and $\II$ both have $G$ actions, the quotient $R/\II$ is not just a module but a representation of $G$.  Since $G$ is finite, the set of representations are discrete, and $\II$ and $\mathcal{J}$ can't be deformed into each other if $R/\II$ isn't isomorphic to $R/\mathcal{J}$ as a representation of $G$.  

Thus, instead of just recording the dimension of $R/\II$, we should record which representation of $G$ it is.

\begin{definition}
Let $G$ be any group acting on $\C^2$, and $V$ an $n$-dimensional representation of $G$. We define $\Hilb_V([\C^2/G])\subset \Hilb_V(\C^2)^G$ by
 $$\Hilb_V([\C^2/G])=\{\II|R/\II\cong V\}$$
\end{definition}

It turns out that this is the only discrete invariant, as shown by Maclagan and Smith \cite{MS} in a more general setting, following work of Evain \cite{evain1} when $G=\C^*$:

\begin{lemma}[Maclagan Smith] 
  Let $G$ be an abelian group.  Then $\Hilb_V([\C^2/G])$ is connected.
\end{lemma}


For $0\leq m< r$ let $V_m$ be the one dimensional representation of $\Z_r$ where $g$ acts by $\zeta^m$.  

\begin{example}
We saw that $\Hilb_2(\Sur_{k/r})$ consisted of two points when $k>1$; these two points were the ideals $(x,y^2)$ and $(x^2,y)$.  In the first case, $R/\II$ has a basis given by $1$ and $y$, and so $R/\II\cong V_0\oplus V_k$.  In the second case, $R/\II$ has a basis given by $1$ and $x$, and so $R/\II\cong V_0\oplus V_1$.
\end{example}

\begin{remark} \label{rmk:smoothregular}
The discussion also clarifies why the $n$ in $\Hilb_n([\C^2/G])$ does not correspond to the number of points.   Smooth points of $\C^2/G$ correspond to points in $\C^2$ where $G$ acts freely, that is, the orbit $Gp$ consists of $|G|$ distinct points.

If $\mathcal{O}_{Gp}$ is the structure sheaf of the orbit of such a point, then the action $G$ on $\mathcal{O}_{Gp}$ is the induced representation of $G$ acting on itself, that is, the regular representation $\C[G]$. Thus, a smooth point of $\C^2/G$ correspond to copies of the regular representation.
\end{remark}

\begin{example}
  Consider $\Hilb_{\C[G]}([\C^2/G])$, often called $G-\Hilb$ in the literature.  The above discussion shows that the locus parameterizing ideals $\II\in\R$ with support at $|G|$ distinct points will be isomorphic to the smooth locus of $\C^2/G$.

  Since the image of the Hilbert-Chow morphism is the $G$ invariant sets, we really have a map $G\Hilb\to \C^2/G$ that is an isomorphism away from the singular points.  Finally, we know $G\Hilb$ is smooth, and and so we see $G-\Hilb$ is a resolution of $\C^2/G$. 
\end{example}

  
\begin{center}
\begin{tikzpicture}[scale=.5]
\draw(0,-4) node{$\widetilde{S}_{1/2}$};
\draw[-latex] (3,0)--(9,0);

\draw (0,2.236) ellipse (2 and 1);
\draw (0,-2.236) ellipse (2 and 1);
\draw[red] (0,0) ellipse (2 and 1);
\fill[white] (-2,0)--(2,0)--(2,1.1)--(-2,1.1)--cycle;
\fill[white] (-2,-2.336)--(2,-2.336)--(2,-1.136)--(-2,-1.136)--cycle;
\draw[dashed] (0,-2.236) ellipse (2 and 1);
\draw[red,dashed] (0,0) ellipse (2 and 1);

\draw (2,2.236)--(2,-2.236);
\draw (-2,2.236)--(-2,-2.236);

\begin{scope}[xshift=12cm]
\draw (0,-4) node{$S_{1/2}$};
\draw (0,2.236) ellipse (2 and 1);
\draw (0,-2.236) ellipse (2 and 1);
\fill[white] (0,0)--(1.7888, -1.7888)--(-1.7888,-1.7888)--cycle;
\draw (-1.7888,-1.7888) -- (1.78888,  1.7888);
\draw (1.7888,-1.7888) -- (-1.78888,  1.7888);
\draw[dashed] (0,-2.236) ellipse (2 and 1);
\end{scope}
\end{tikzpicture}
\end{center}

In fact, singularities of the form $\C^2/G$ have a unique minimal resolution, and $G-\Hilb$ is this resolution:


\begin{theorem} \label{thm:GHilb-resolution}
The Hilbert-chow morphism $G-\Hilb\to \C^2/G$ is the minimal resolution.
\end{theorem}


\subsection{Topology of orbifold Hilbert schemes}

The methods used to study the topology of Hilbert schemes of points on $\C^2$ adapts easily to Hilbert schemes of points on $[\C^2/G]$ when $G$ is abelian.  We view $\Hilb([\C^2/G])$ as $\Hilb(\C^2)^G$.  When $G$ is abelian, its action can be simultaneously diagonalized.  We use the $T=(\C^*)^2$ to be the one acting on the diagonal coordinates for $G$, so that $G\subset T$, and the actions of $G$ and $T$ commute. 

Since $T$ commutes with $G$, the $T$ action will preserve $G$ fixed point sets, and we get a $T$ action on $\Hilb_n(\C^2)^G$.  Using this $T$ action, we can determine the topology of $\Hilb_n(\C^2)^G$ in exactly the same manner as we did $\Hilb_n(\C^2)$.



\begin{lemma} Let $G$ be an abelian group acting on $\C^2$.  Then
\[ \chi( \Hilb_n([\C^/G]))=p(n) \]
\end{lemma}

\begin{proof}
Since $G\subset T$, we have $\Hilb_n(\C^2)^{\C^*}\subset\Hilb_n(\C^2)^G$, and so all the monomials ideals are $G$ invariant.  
\end{proof}

Similarly, we can use the Ellingsrud-Str\o mme's calculation of torus weights on $T_\lambda\Hilb_n$ to use the Bia\l ynicki-Birula decomposition to find the Betti numbers of $\Hilb_n([\C^2/G])$.  

In general, if $G$ is a group acting on a manifold $M$ and $p\in M^G$ is a fixed point, the tangent directions of $M^G$ at $p$ are just the $G$-fixed tangent directions to $p$ in $M$: $T_p(M^G)=(T_pM)^G$.  

Thus, if $\II\in \Hilb_n([\C^2/G])$ is a monomial ideal, we have
$$T_{\II}\Hilb_n(\Sur_G)=\left(T_{\II}\Hilb_n(\C^2)\right)^G$$
i.e., the tangent space to $\Hilb_n(\Sur_G)$ consists of the $G$ invariant part of the whole tangent space.

Thus, Ellingsurd and Str\o mme's calculation quickly adapts to compute the bett.  For $G$ a finite cycle group, a term in Lemma \ref{lem:torus-weights} will be $G$ invariant if and only if the arm and leg satisfy some linear congruence relation; for $G$ a product of two cyclic groups, it will be a system of linear relations.


\begin{definition}
Let $\lambda$ be a partition of $n$, and $k<r$ relatively prime.  We define 
\[\dim_{k/r}(\lambda)=\dim T_\lambda\Hilb_n(\Sur_{k/r})\]
Furthermore, let $\C^*$ act on $\C^2$ with weights $(\varepsilon, 1)$, and consider the induced $\C^*$ action on $\Hilb_n(\Sur_{k/r})$.  We define 
\[\dim^{\pm}_r \lambda =\dim T^\pm_\lambda(\Hilb_n(\Sur_{k/r})\]
to be the dimensions of the positive and negative eigenspaces of this action. 
\end{definition}

\begin{lemma} \label{lem:dimkr}
  We have
\begin{align*}
\dim_{k/r}(\lambda)&=\#\left\{\square\in\lambda \Big | \ell(\square)-k a(\square)\in\{-1,k\} \pmod r\right\} \\
\dim^+_{k/r}(\lambda)& =\#\left\{\square\in\lambda \Big | \ell(\square)-k a(\square)=-1 \pmod r \text{ and } a(\square)>0\right\} \\
\dim^-_{k/r} &= \dim_{k/r}-\dim^+_{k/r}
\end{align*}
\end{lemma}
\begin{proof}
Let $L$ denote the representation where the standard generator of $G_{k/r}$ acts as $\exp(2\pi i/r)$. Under the inclusion $i:G_{k/r}\in T$, we have $i^*(T_1)=L, i^*(T_2)=L^k$.  Thus, we see that as a $G_{k/r}$-rep, we have
$$T_\lambda \Hilb_n(\C^2)=\sum_{\square\in\lambda} L^{-\ell(\square)+ka(\square)+k}+L^{\ell(\square)+1-ka(\square)}$$
The tangent space to $\Hilb_n(\Sur_{k/r})$, being the $G$ invariant directions, will correspond to the exponents that are divisible by $r$.  This immediately gives the first line.

To find the dimension of positive and negative eigenspaces  we intersect our answer to the first line with Prop whatever.

The last line follows since fixed $\C^*$ fixed points are isolated, and hence there are now eigenvectors with eigenvalue 0.
\end{proof}

\begin{definition}
We define $\Hilb_{k/r}=\sum_{n=0}^\infty \Hilb_{n}(\Sur_{k/r})q^n$.
\end{definition}

\begin{corollary} \label{cor:orbibettipartitions}
\begin{align*} [P_t(\Hilb_{k/r})&=\sum_{\lambda\in\PP}q^{|\lambda|}t^{2\cdim^+_{k/r}(\lambda)} \\
  [\Hilb_{k/r}]&=\sum_{\lambda\in\PP}q^{|\lambda|}\LL^{\cdim^-_{k/r}(\lambda)}
\end{align*}
\end{corollary}

Corollary \ref{cor:orbibettipartitions} reduces the computation of $P_t(\Hilb_{k/r})$ to the combinatorics of partitions.  The right hand side is easily implemented by computer to allow for the computation of these generating functions.  We have implemented this in Sage math, and from this have conjectured an infinite product formula for $P_t(\Hilb_{k/r})$, which we present in the next section.

\section{Conjectured product formula}

In this section we state the conjectured product formula.  Section \ref{sec:prod-start} gives some examples and describes the general form the product formula takes.  In Section \ref{sec:prod-CR} we give an explicit conjectural formula in terms of Chen-Ruan cohomology, while in Section \ref{sec:prod-comb} we give an explicit conjectural formula relating interchanging arms and co-legs.  Section \ref{sec:prod-equiv} proves the equivalence of the two formulations of the conjecture.


\subsection{Initial observations toward the product formula}
\label{sec:prod-start}

To state our conjectural product formula, it is convenient to use the Pochhammer symbol 
$$(a;x)_\infty:=\prod_{\ell\geq 0} (1-ax^\ell)$$
We will also use the following extension of the Pochhammer symbol:
$$(a_1,\dots, a_n; x)_\infty=\prod_{i=1}^n (a_i;x)_\infty$$

\begin{example}{G\"ottsche's formula}
Using the Pochhammer symbol, G\"ottsche's formula becomes:
$$\sum_{n\geq 0} b_k(\Hilb_n(S))t^kq^n=\frac{(-qt;qt^2)_\infty^{b_1}(-qt^3;qt^2)_\infty^{b_3}}{(q;qt^2)_\infty^{b_0}(qt^2;qt^2)_\infty^{b_2}(qt^4;qt^2)_\infty^{b_4}}$$
\end{example}

\begin{example}[The antidiagonal action: $Z_r\subset SL_2$] \label{ex:tcorequot}
In case $G=\frac{1}{r}(1,-1)\subset SL_2$, product formulas are already known, and can be proven geometrically using , or combinatorially using cores and quotients (as we illustrate in Section ):

$$P_t(\Hilb_{-1/r})=\prod_{m\geq 1} \frac{(1-q^{mr})^r}{1-q^m} \prod_{k\geq 1} \frac{1}{(1-q^{rk})}\frac{1}{(1-t^{2k}q^{rk})^k}$$
Here, the product over $m$ is the generating function for $r$-cores, and the product over $k$ is a $t$-analog of the generating function for $r$-quotients.
\end{example}

Before stating our general conjectured product formula, we first look at the simplest examples:

\begin{example}[GZLMH's $\Z_3$ example]
In \cite{GLM}, Gusein-Zade, Luengo, Melle-Hern\'andez conjectured
$$P_t(\Hilb_{1/3})\stackrel{?}{=}\frac{1}{(1-q)}\frac{1}{(1-qt^2)}\frac{1}{(1-q^3)}\frac{1}{(1-q^4t^2)}\frac{1}{(1-q^5t^4)}\frac{1}{(1-q^6t^2)}\cdots$$
Using the Pochhammer symbol, this becomes
\begin{equation*}
\begin{split}
\DC_{1/3}&\stackrel{?}{=}\frac{1}{(q;t^2q^3)_\infty}\frac{1}{(q^2t^2;t^2q^3)_\infty}\frac{1}{(q^3;t^2q^3)_\infty} \\
&\stackrel{?}{=}\frac{1}{(q,q^2t^2,q^3;t^2q^3)_\infty}
\end{split}
\end{equation*}
\end{example}

\begin{example}[$\Z_5$ actions]
  For $\Z_5$, there are two groups not contained in $SL_2$, the diagonal action $\frac{1}{5}(1,1)$ and $\frac{1}{5}(1,2)=\frac{1}{5}(1,3)$.  From computations, it appears that:
  \begin{align*}
    \DC_{1/5}&\stackrel{?}{=}\frac{1}{(q,q^2t^2,q^3,q^4t^2, q^5; q^5t^2)_\infty} \\
    \DC_{2/5}&\stackrel{?}{=}\frac{1}{(q,q^2,q^3t^2,q^4t^2, q^5; q^5t^2)_\infty}
    \end{align*}

  Both product formulas are $t^2$-analogs of the usual Euler product, where the power of $t^2$ attached to $q^n$ grows roughly as $n/5$, and we round up or down depending on the residue of $n\pmod 5$.

  More specifically, in each case we have $\DC_G=\prod(1-q^nt^{2w_G(n)})$, where $w_G(n)=\lfloor n/5\rfloor + \epsilon_G(n)$, and
\begin{align*}
\epsilon_{1/5}(n)&=\left\{\begin{array}{ll} 0 & n\cong 0,1,3 \pmod 5 \\ 1 & n\cong 2,4 \pmod 5\end{array}\right. \\
\epsilon_{2/5}(n)&=\left\{\begin{array}{ll} 0 & n\cong 0,1,2 \pmod 5 \\ 1 & n\cong 3,4 \pmod 5\end{array}\right.
\end{align*}


\end{example}

  In the previous two examples the intersection of $G$ with $SL_2$ was trivial, it appeared that $P_t(\Hilb_G)$ was a $t^2$-analog of the Euler product.  Meanwhile, Example \ref{ex:tcorequot} shows that when $G\subset SL_2$, $P_t(\Hilb_G)$ is a $t^2$-analog of the cores and quotients infinite product.

  When $G$ is not contained in $SL_2$ but has a nontrivial intersection, the generating function $\DC_G$ appears to contain elements from both.

\begin{example}[Diagonal $\Z_4$-conjecture of GZLMH]

  When $G=\frac{1}{4}(1,1)$ is $\Z_4$ acting diagonally, then $G\cap SL_2=Z_2$.

  Gusein-Zade, Luengo, Melle-Hern\'andez made the following conjecture:
$$\DC_{1/4}=\frac{(q^2;q^2)^2_\infty}{(q;q^2)_\infty} \frac{1}{(q^2, t^2q^2, q^4, t^2q^4;t^2q^4)_\infty}$$
We see that this is a $t^2$-analog of the 2-cores and quotients product.
\end{example}

To summarize these, and extensive other computer examples, it appears that if $|G\cap SL_2|=k$, then $P_t(\Hilb_G)$ is a $t^2$-analog of the $k$-cores and quotient product (where we take the 1-core and quotient product to be the Euler product).  

More specifically, it seems that
$$P_t(\Hilb_G)=\frac{(q^k;q^k)^k_\infty}{(q;q)_\infty}
\prod_{m=1}^{r/k}\frac{1}{(q^{km}t^{\epsilon^G_{1,m}},q^{km}t^{\epsilon^G_{2,m}},\dots,q^{km}t^{\epsilon^G_{k,m}} ;q^rt^2)_\infty}$$
with $\epsilon^G_{i,j}$ either 0 or 2; the question is then to describe $\epsilon^G_{i,j}$.


In G\"ottsche's formula, terms with $\epsilon(h)=0$ correspond to elements of $H_0(S)$, and terms with $\epsilon(h)=2$ corresponds to elements of $H_2(S)$. Thus, one might hope for a description of the $\epsilon(h)$ in terms of the cohomology of the stack $[\C^2/G]$.  The correct cohomology theory to use appears to be Chen-Ruan cohomology.

\subsection{Product formula: geometry}
\label{sec:prod-CR}

\subsubsection{Chen-Ruan cohomology}

The Chen-Ruan cohomology $H_{CR}^*(\mathcal{X})$ of an orbifold $\mathcal{X}$ was discovered as a byproduct of defining the quantum cohomology of such orbifolds \cite{chenruancohomology}.  As a vector space, the Chen-Ruan cohomology is the usual cohomology of the inertial orbifold $\mathcal{IX}$ of $\mathcal{X}$.  As a set $\mathcal{IX}$ is the space of constant maps from $S^1$ to $\mathcal{X}$; more algebraically, 
$$\mathcal{IX}=\{(x, (g)| x\in \mathcal{X}, (g)\in\textrm{conj}(G_x)\}$$
Every isotropy group $G_x$ has an identity element $e_x$, the subset of $(x, e_x)$ naturally forms a copy of $X$.  Elements $(x,(g))$ with $(g)$ nontrivial form other components of $\mathcal{IX}$ called \emph{twisted sectors}.

Thus, for $\mathcal{X}=[\C^2/G]$, we see that 
$$H_{CR}^*(\mathcal{X}) =H^*(\mathcal{IX})=\oplus_{g\in\textrm{conj}(G)} (\C^2)^g$$
has a basis indexed by conjugacy classes of $G$.

However, Chen-Ruan cohomology has a different product and grading than $H^*(\mathcal{IX})$.  Each twisted sector has a \emph{degree shifting number}, or \emph{age} $\iota(g)$, obtained as follows.

Since $g\in G_x$, and $g$ acts on $T_x$.  It acts trivially on the tangent directions to fix($g$), and nontrivial on the normal directions.  Diagonalizing the action on the normal bundle, we see that $g$ is a diagonal matrix with entries 
$$(\exp(2\pi i a_1/r), \exp(2\pi i a_2/r), \cdots \exp(2\pi i a_m))$$
for some integers $0<a_i<r$.
Then $\iota(g)=\sum a_i/r$; sometimes called the logarithmic trace of $g$.



The grading shift number is in general only a rational number: $\iota(g)\in \Z$ if and only if the determinant of $g$ is trivial.  Thus, in case all isotropy groups $G_x$ are in $SL_2$, then the Chen-Ruan cohomology is integrally graded.

\begin{example}[The diagonal action]
Let $\Z_r$ act diagonally, with element $g_k$ acting as $(\exp(k2\pi i/r),\exp(k2\pi i/r))$.  Then we have $\iota(g_k)=2k/r$.
\end{example}


\begin{example}[Antidiagonal action]
When $G\subset SL_2$, we have that 
$$\iota(g)=\left\{\begin{array}{rl} 0 & g=0 \\
1 & g\neq 0 \end{array}\right.
$$

Thus, the dimension of $H_{CR}^*([\C^2/G])$ is equal to the number of conjugacy classes of $G$.  We have $H_{CR}^0$ is one dimensional, with all other classes having cohomological degree 2.  Since the number of conjugacy classes is the number of irreps, then comparing this with the McKay correspondence \ref{ }gives:
$$H_{CR}^*([\C^2/G])\cong H^*(\widetilde{S}_G)$$
as graded vector spaces (actually, as rings in this case).  
\end{example}

In fact, the Chen-Ruan cohomology agreeing with a cohomology of a particularly nice resolution was one of the motivations for its introduction.  Recall that a resolution $f:X\to Y$ is \emph{crepant} if $f^*(K_Y)=K_X$.  

\begin{theorem}[Yasuda \cite{yasuda}] \label{thm:yasuda}
Let $\mathcal{X}$ an effective orbifold, and $\widetilde{X}\to|\mathcal{X}|$ a crepant resolution of the coarse moduli space.  Then :
$$H_{CR}^*(\mathcal{X})=H^*(\widetilde{X})$$
as graded vector spaces.  
\end{theorem}

Note that the ring structure of $H_{CR}^*(\mathcal{X})$ and $H^*(\widetilde{X})$ will not in general agree, so called ``quantumn corrections'' may be needed.  The \emph{Crepant Resolution Conjecture} states that, properly understood, the quantumn cohomology of $\mathcal{X}$ and $\widetilde{X}$ should agree.  See \cite{CoatesRuan} for discussion of the details and reference to other sources.

Let $\rho:G\to\C^*$ be the action of $G$ on $\wedge^2T^*\C^2$.  Then $\rho(g)=\exp\big(-2\pi i \iota(g)\big)$, and the kernel of $\rho$ is precisely $G\cap SL_2$.




Our conjectural product formula for $\DC_G$ is easiest to state in case $G\cap SL_2=1$.  In this case, the action of $G$ on $\wedge T^*\C^2$ is faithful; taking $r$ times the logarithmic trace of this action gives a bijection between $G$ and $\{0,\dots, r-1\}$.


Let $F(g)$ and $I(g)$ denote the fractional and integral parts of $\iota(g)$. 

If $G\cap SL_2=\{1\}$, then $F(G)$ gives a bijection between $G$ and $\{0, 1/r,\dots, (r-1)/r\}$.
\begin{conjecture}[Johnson] \label{conj:CR}
Let $G$ be cyclic, and define $k=|G\cap SL_2|$

$$\mathcal{H}_G(q,t)= \frac{(q^k;q^k)^k_\infty}{(q,q)_\infty} \prod_{g\in G}\frac{1}{(q^{r(1-F(g))} t^{2I(g)},q^rt^2)_\infty}$$

\end{conjecture}


\begin{example}[Diagonal action, $r$-odd] \label{ex:diagonalconjecture}
Let $r=2k+1$.   The element of $\Z_r$ that acts on $K$ as $\exp(2\pi i/r)$ acts on the tangent space as $\exp(2\pi i k/r)$, and thus as $\iota=2k/(2k+1)<1$.  

Odd powers of this element will have $\iota<1$, while even powers will have $\iota>1$, giving
$$P_t(\Hilb_{1/r})\stackrel{?}{=} \prod_{k\leq r \text{ odd}} \frac{1}{(q^k; q^rt^2)_\infty} \prod_{k<r \text{ even}} \frac{1}{(q^kt^2; q^rt^2)_\infty}$$

\end{example}


\begin{remark}
  Buryak-Feigin give an infinite product formula for the topology of $\C^*$-fixed point loci, where $\C^*$ acts as $t\cdot(x,y)=(t^ax,t^by)$.  There results arise naturally as limits of our product formula as $r\to \infty$, where we take finite groups $\Z_r$ acting as $\frac{1}{r}(a,b)$ for appropriate values of $r$.
  For example, if we take $r\to\infty$, along odd $r$, for  along our conjecture 
  In the limit as $r\to\infty$ odd, we get Buryak-Feigin's result
  $$\prod_{n \text{ odd}} \frac{1}{1-q^n}\prod_{m \text{ even}}\frac{1}{1-tq^m}$$



\end{remark}


\begin{example}[$S_{2/5}$]
We have
$$\begin{array}{r|c|l}
g & r(1-F(g)) & I(g) \\
\hline
1 & 2 & 0 \\
2 & 4 & 1 \\
3 & 1 & 0 \\
4 & 3 & 1 \\
\end{array}
$$

Thus, we have


$$
\frac{1}{(q, q^2,q^3t, q^4t, q^5t^2; q^5t^2)_\infty}
$$
\end{example}


\subsection{Product formula: combinatorics}
\label{sec:prod-comb}

We now give a different description of the product formula, at least for the case when $G\subset SL_2=1$, with motivation coming from combinatorics.  In particular, our conjecture is a strengthening of results of Bacher-Manivel \cite{BM} and Bessenrodt \cite{Bess}, which show that the total number cells in all partitions of $n$ with arm length $A$ and leg length $L$ is equal to the total number of parts of size $A+L+1$ in partitions of $n$.

\subsubsection{ }

The combinatorial motivation for the distribution of $\cdim_{k/r}(\lambda)$ is to define a new statistic, $\dusty_{k/r}$ that simply replaces arm with the co-leg.
\begin{definition}
$$\dusty_{k/r}(\lambda)=\#\left\{\square\in\lambda\Big| \ell(\square)-k\coleg(\square)=-1\pmod r\right\}$$
\end{definition}

The immediate benefit of this definition is that this both $\ell(\square)$ and $\coleg(square)$ depend only on the row $\square$ is in, and not on the global shape of the partition.  Thus, viewing the rows of the partition as the parts of the partition, it is immediate that the $(q,t)$-enumeration of partitions has a product formula that is just a $t$-deformation of the standard Euler product, that is, we have

$$\sum_{\lambda\in \PP} q^{|\lambda|} t^{|\dusty_{k/r}(\lambda)|}=\prod_{m\geq 1} \frac{1}{1-q^mt^{z_{k/r}(m)}}$$
for some function $z(m)$.

It is an easy observation that when $k+1$ is relatively prime to $r$, then $z_{k/r}(m)$ has the same basic structure as the weights $w_{k/r}(m)$ appearing in the distribution of 

\begin{lemma} \label{lem:dusty-lemma}
If $(k+1,r)=1$, then 
$$w_{k/r}(m)=\varepsilon_{k/r}(m)+\lfloor m/r\rfloor$$
where $\varepsilon_{k/r}(m)$ is either 0 or 1 and only depends on $m\pmod r$.
\end{lemma}

\begin{proof}
This follows from the fact that, as we move one box to the left in a row, $\ell(\square)-k\coleg(\square)$ increases by $k+1$.  Thus, when $k+1$ is relatively prime to $r$, in any string of $r$ boxes in a single row, $\ell(\square)-k\coleg(\square)$ will take on every residue class $\pmod r$ exactly once. 
\end{proof}

\begin{conjecture} \label{conj:dusty}
$$\sum_{\lambda\in \PP} q^{|\lambda|} t^{|\dusty_{k/r}(\lambda)|}=\sum_{\lambda\in \PP} q^{|\lambda|} t^{|\cdim_{k/r}(\lambda)|}$$
\end{conjecture}


\begin{example}
Consider $\dusty_{1/r}$, for $r$ 

\end{example}


\begin{proposition}
If we take the first derivative of Conjecture \ref{conj:dusty} with respect to $t$, and then set $t=1$, then the resulting equation is true.  
\end{proposition}

\begin{proof}
First, consider the left hand side; $\sum_{\lambda\in\PP} q^{|\lambda|} t^{\cdim(\lambda)}$.  If we take the derivative of $t$ and set $t=1$, we get 
$$\sum_{n} q^n\sum_{\lambda\in\PP_n}\sum_{\square\in\lambda} \delta(\ell(\square)-k\coleg(\square)=-1\pmod r),$$
that is, the coefficient of $q^n$ is the total number of squares in all partions of $n$ that have $\ell(\square)-k\coleg(square)=-1\pmod r$.  

  Here, a part of length $L$ will contribute 

Similarly, when we take the derivative with respect to $t$ and set $t=1$ on the right hand side, the coefficient of $q^n$ is the total number of squares in all partitions of $n$ with $\ell(\square)-k a(\square)=-1\pmod r$. 

For any possible non-negative values $L$ and $A$ satisfying $L-kA=-1\pmod r$, we can count the number of squares $\square$ in all partitions of $n$ with $a(\square)=A$ and $\ell(\square)=L$.  By the results of Bacher Manivel and Bessenrodt, this is equal to the number of all parts of length $A+L+1$ in all partitions of $n$.  

But for any such values of $L$ and $A$, in every part of size $A+L+1$ there will be a unique $\square$ with $\coleg(\square)=A$ and $\ell(\square)=L$, and and this square will contribute to the left hand side.


\end{proof}



\subsection{Equivalence of the two product formulas}
\label{sec:prod-equiv}

\begin{proposition}
Conjecture \ref{conj:CR} is equivalent to Conjecture \ref{conj:dusty}
\end{proposition}

\begin{proof}
By Lemma \ref{prop:dusty-lemma}, we only need to prove that the powers of $t$ in the two conjectural product formulas agree for the first $r$ terms; that is, we need to show that $\epsilon_{k/r}(m)=\varepsilon_{k/r}(m)$ for $1\leq m\leq r$.  

Now, for $\varepsilon_{k/r}(m)=1$, we need 
\begin{align*}
0 &\in \{m, m-(k+1),\dots, m-(m-1)(k+1) \} \\
-m &\in \{0, -(k+1),\dots,-(m-1)(k+1) \} \\
\frac{-m}{k+1} &\in \{0, -1, \dots, -(L-1) \} \\
\end{align*}
Where we have worked in $\mathbb{Z}_r$.  Equivalently, if we choose the representative of $[-m/(k+1)]\in \mathbb{Z}/r\mathbb{Z}$ to be in in $\{0,\dots, r-1\}$, then we need $-m/(k+1)>-m$.

From the Chen-Ruan point of view, a part of length $m<r$, with $ m\cong-(k+1)s\pmod r$ will contribute if we have to carry when we add $s$ and $ks$, that is 
\begin{align*}
k s &\in\{ -1,\dots, -s \}\\
(k+1)s &\in\{ 0,\dots, s-1\} \\
m&\in\{ 0,-1,\dots, -s+1\} \\
m& \in \{0, -1,\dots, m/(k+1)+1\}
\end{align*}
That is, we need $m>m/(k+1)$, if we choose the representative of $m/(k+1)\in\Z_r$ to be $<r$.

\end{proof}






\subsection{Colored boxes}

We have computed reduced the betti numbers of $\Hilb_n(\Sur_{k/r})$ to partition combinatorics.  We would now like to extend this and understand the betti numbers of each individual component $\Hilb_V(\Sur_G)$ for a representation $V$ of $G$.  This is easily done by \emph{coloured box counting}.

Let $\lambda$ be a partition of $n$; we want to know $R/\II_\lambda$ as a representation of $\Z_r$.  The monomials within $\lambda$ give a basis of $R/\II_\lambda$, and $\Z_r$ acts diagonally on this basis: $x^ay^b$ has weight $a+bk\pmod r$.

To visualize this, it is convenient to colour the squares in the first quadrant with $r$ different colours, which we identify with the elements of $\Z_r^*$.  We colour the square $(a,b)$ with colour $a+bk\pmod r$.  


The follow picture illustrates this with the three actions of $\Z_r$; the action for $\frac{1}{5}(1,3)$ is obtained from that for $\frac{1}{5}(1,2)$ by interchanging the $x$ and $y$ axes.

\begin{tikzpicture}[scale=.4]
\begin{scope}
\draw (3.5,8.5) node{$\frac{1}{5}(1,1)$};
       \clip (0,0) rectangle (7,7);
\foreach \x in {0,...,6}{%
    \foreach \y in {-2,...,2}{%
       \draw[fill=red!20]  (\x, -\x+5*\y) rectangle (\x+1, -\x+5*\y+1); 
       \draw[fill=green!20]  (\x, -\x+5*\y+1) rectangle (\x+1, -\x+5*\y+2); 
       \draw[fill=blue!20]  (\x, -\x+5*\y+2) rectangle (\x+1, -\x+5*\y+3); 
       \draw[fill=black]  (\x, -\x+5*\y+3) rectangle (\x+1, -\x+5*\y+4);
        \draw  (\x, -\x+5*\y+4) rectangle (\x+1, -\x+5*\y+5); 
}}
\end{scope}     

\begin{scope}[xshift=10cm]
\draw (3.5,8.5) node{$\frac{1}{5}(1,2)=\frac{1}{5}(3,1)$};
\begin{scope}[xscale=-1, rotate=90]
       \clip (0,0) rectangle (7,7);
\foreach \x in {0,...,6}{%
    \foreach \y in {-4,...,2}{%
       \draw[fill=red!20]  (\x, 3*\x+5*\y) rectangle (\x+1, 3*\x+5*\y+1); 
       \draw[fill=green!20]  (\x, 3*\x+5*\y+1) rectangle (\x+1, 3*\x+5*\y+2); 
       \draw[fill=blue!20]  (\x, 3*\x+5*\y+2) rectangle (\x+1, 3*\x+5*\y+3); 
       \draw[fill=black]  (\x, 3*\x+5*\y+3) rectangle (\x+1, 3*\x+5*\y+4);
        \draw  (\x, 3*\x+5*\y+4) rectangle (\x+1, 3*\x+5*\y+5); 
}}
\end{scope}
\end{scope}     

\begin{scope}[xshift=20cm]
\draw (3.5,8.5) node{$\frac{1}{5}(1,4)$};
\begin{scope}[xscale=-1, rotate=90]
       \clip (0,0) rectangle (7,7);
\foreach \x in {0,...,6}{%
    \foreach \y in {-2,...,2}{%
       \draw[fill=red!20]  (\x, \x+5*\y) rectangle (\x+1, \x+5*\y+1); 
       \draw[fill=green!20]  (\x, \x+5*\y+1) rectangle (\x+1, \x+5*\y+2); 
       \draw[fill=blue!20]  (\x, \x+5*\y+2) rectangle (\x+1, \x+5*\y+3); 
       \draw[fill=black]  (\x, \x+5*\y+3) rectangle (\x+1, \x+5*\y+4);
        \draw  (\x, \x+5*\y+4) rectangle (\x+1, \x+5*\y+5); 
}}
\end{scope}     
\end{scope}

\end{tikzpicture}

\begin{definition} \label{def:coloredsize}
  Let $G$ be a finite abelian group acting on $\C^2$, and $\lambda$ a partition.  We define:
  $$|\lambda|^G=[R/\II_\lambda]\in K^0(G)$$
  Following Definition , we write $|\lambda|^G_i$ to be the dimension of the $i$th isotypical componentof $R/\II_\lambda$.  Equivalently, $|\lambda|^G_i$ is the number of boxes with color $i$ in $\lambda$.
  When $G=\frac{1}{r}(1,k)$, we will write $|\lambda|^{k/r}$ for $|\lambda|^G$, which is potentially confusing, but we will never a have reason to raise $|\lambda|$ to a power.
\end{definition}

Given Definition \eqref{def:coloredsize}, it is natural to consider the function
$$P_G(q_0,\dots,q_{r-1})=\sum_{\lambda\in\mathcal{P}} \mathbf{q}^{|\lambda|^G}$$
where 
$$\mathbf{q}^{|\lambda|_G}=\prod_{i=0}^{r-1} q_i^{|\lambda|^G_i}$$
that counts partitions according to their full colored square count as opposed to just their size.  Geometrically, the coefficient of $\mathbf{q}^v$ is the euler characteristic of $\Hilb_v([\C^2/G])$, and hence $P_G(q_0,\dots,q_{r-1})$ could be viewed as the Euler characteristic of an obvious multigraded space version Hilbert scheme.


We will not say too much about $P_G$, but summarize a few results from the literature.  Let $G=Z_r\subset SL_2$, and set $Q=q_0q_1\cdots q_{r-1}$.  We will see later using cores and quotients that in this case $P_G$ is essentially a multivariable theta function.  

Since $P_G$ is then closely related to modular forms, one might then ask if it has an infinite product formula.  When $r=2$, the Jacobi triple product formula provides just this.  In fact, Boulet \cite{boulet} shows that actually the case $G=\Z_2\times \Z_2$ has an infinite product expansion.  Letting $q_{00}, q_{01}, q_{10}, q_{11}$ denote the variables, we have

\begin{theorem}[Boulet \cite{boulet}]
$$P_{\Z_2\times\Z_2}=\prod_{i=1}^\infty \frac{(1+q_{00}^jq_{01}^{j-1}q_{10}^{j-1}q_{11}^{j-1})(1+q_{00}^jq_{01}^jq_{10}^jq_{11}^{j-1})}{(1-q_{00}^jq_{01}^jq_{10}^jq_{11}^j)(1-q_{00}^jq_{01}^jq_{10}^{j-1}q_{11}^{j-1})(1-q_{00}^jq_{01}^{j-1}q_{10}^{j}q_{11}^{j-1})}$$
\end{theorem}

However, even the one variable specialization $P_{\Z_3}(q,1,1)$ does not have a nice infinite product expression, as observed by Bal\'azs Szendr\"oi \cite{Bmo}: it has a root at $-e^{\pi/\sqrt{3}}$ \cite{Borwein2}.

However, coloured box counting will still play an important role for us.  As observed in Remark \ref{rmk:smoothregular}, adding a smooth point of $[\C^2/G]$ corresponded not to increasing the dimension of $R/\II$ by 1, but by a copy of the regular representation.  In terms of colored boxes, this corresponds to adding one box of each color.  We will let $\Reg\in K^0(G)$ denote the class of the regular representation.

Let $v\in K^0(G)$.  Geometrically, it is clear that if $\Hilb_v$ is nonempety, then so is $\Hilb_{v+\Reg}$, as we can just add a generic smooth point.  Combinatorially, this translates to the following. Suppose that $|\lambda|^G=v$, and let $\lambda^\prime$ be obtained from $\lambda$ by adding a $1\times r$ strip to the bottom right corner $\lambda$.  Then $|\lambda^\prime|=v+\Reg$.

\begin{lemma}
Let $v\in K^0(G)$.  Then there exists an $m$ so that $\Hilb_{v+m\Reg}$ is non-empty, i.e., there exists a $\lambda$ with $|\lambda|^G=v+m\Reg$.
\end{lemma}


\begin{wrapfigure}{r}{.3\textwidth}
\begin{tikzpicture}[scale=.3]
\begin{scope}[xscale=-1, rotate=90]
       \clip (0,0) rectangle (12,12);
\foreach \x in {0,...,11}{%
    \foreach \y in {-4,...,4}{%
       \filldraw[red!20]  (\x, \x+3*\y) rectangle (\x+1, \x+3*\y+1); 
       \filldraw[green!20]  (\x, \x+3*\y+1) rectangle (\x+1, \x+3*\y+2); 
       \draw[gray] (0,0) grid (12,12);
}}
\end{scope}     
\draw[very thick] (0,9)--(3,9)--(3,6)--(6,6)--(6,3)--(9,3)--(9,0);
\draw[very thick, dashed] (0,10)--(1,10)--(1,9);
\draw[very thick, dashed] (3,7)--(4,7)--(4,6);
\draw [very thick, dashed] (6,6)--(8,6)--(8,4)--(9,4)--(9,3);
\draw [very thick, dashed] (9,3)--(11,3)--(11,1)--(12,1)--(12,0);
\end{tikzpicture}
\end{wrapfigure}
Let $\mu$ be a block staircase partition, with blocks squares with side length $|G|$; for instance, take $\mu$ to be the space under the thick line in the diagram to the right.  Then clearly $|\mu|=m\Reg$ for some $m$.  If we then add a $k\times |G|$ rectangle to a given step of $\mu$, we have added $k\Reg$ to the colored box count; we can then add one more box to a given step to add one box of whichever colour we want.  In the figure at right, the top two steps each add a red box, the bottom two steps each add a white box.
Clearly, taking $\mu$ large enough, we can modify the steps appropriately to get $v+n\Reg$ for any $v$ and some $n$.

It is then natural to ask the following questions: given $v\in K^0(G)$, what is the lowest $n\in\Z$ so that there is a partition $\lambda$ with $|\lambda|^G=v+n\Reg$?  Can we describe these $\lambda$?  
\begin{definition}
A partition $\lambda$ is called a $k/r$-core if $\cdim^+_{k/r}(\lambda)=0$/
\end{definition}
  
\begin{lemma}
Let $\overline{K}(G)=K(G)/\Reg$.  Then for every $\overline{v}\in\overline{K}(G)$, there is a unique $k/r$-core $\lambda$ with $|\lambda|^{k/r}=\overline{v}$.
\end{lemma}






%\subsection{Dijkgraaf, orbifold partitions, and the topology of Quot schemes}

%Specialization where one $q_i$ is set to $q$ and all others are set to one is studied in \cite{DS}, where they are all called \emph{orbifold partitions of the first type}.  There, they show that these specializations are characters of the affine Kac-Moody lie algebras.

%We briefly mention that they also introduce \emph{orbifold partitions of the second type}, where only cells of the given color are coordinated.  Combinatorially, this can be viewed as putting an equivalence relation on partitions, so that two partitions are equivalent if they contain exactly the same boxes of color $i$.  Algebraically, instead of considering $G$-equivariant ideals of $R$, this is working $G$-invariantly.  That is, we have the ring $R^G$ of $G$ invariant elements of $R$.  The ring $R$ is a module over $R^G$, and splits into a direct sum of modules indexed by the irreducible representations of $R$.  Rather than counting ideals in $R$ with quotient having length $n$, they are counting submodules of $R_i$ of colength $n$.  

%Geometrically, $R^G$ is the ring of functions on the singular space $\C^2/G$.  The modules $R_i$ are spaces of sections of sheave $\mathcal{F}_i$ that are .  These ideals are $T$ equivariant, and so they correspond to the euler characteristic of the quot scheme.  


%\begin{question} What can be said about the Quot?  Homology groups, decomposition in the grothendieck ring of varieites, etc. How are these related to the topo \end{question}




\subsubsection{Homological stability}

The analogs of stabilization and geometric representation theory work on the level of connected Hilbert scheme.

\begin{theorem} 
$P_t(\Hilb^{\delta+nG}_G)$ stabilizes to $1/(t,t)_\infty^{|G|}$
\end{theorem}
Note that the right hand side is independent of $m$ and $\delta$.
\begin{proof} Combinatorics -- a generalization of cores and quotients of partitions \end{proof}

\begin{conjecture}
The stable cohomology of $\Hilb^{\delta+nG}$ is freely generated by the Chern classes of the $|G|$ tautological bundles.
\end{conjecture}



\subsubsection{Heisenberg Action}


\begin{conjecture}
Let $\delta\in K_0(G)$ be small, and $G$ cyclic.  Then
$$\bigoplus_{k\geq 0} H_*(\Hilb^{\delta+kG}_G)$$ admits the action of a Heisenberg algebra based on the cohomology of the minimal resolution of $\C^2/G$.
\end{conjecture}

Evidence:
Let $c$ be the number of rational curves in the minimal resolution of $\C^2/G$.  Then
$$\mathcal{CH}^\delta_G\cdot(q,qt^2)_\infty\cdot (qt^2,qt^2)_\infty^c$$
has positive coefficients; but higher powers start giving negative coefficients.


\subsubsection{Resolutions of $(\C^2/G)^n/S_n$}
One family of resolutions

Let $S_G$ be the minimal resolution of $\C^2/G$.  Then $\Hilb_n(S_G)$ is a resolution of $(\C^2/G)^n/S_n$.


Another family of resolutions

Let $\delta\in K^0(G)$ be such that $\Hilb^\delta([\C^2/G])=pt$.  Then $\Hilb^{\delta+nG}([\C^2/G])$ is a resolution of $(\C^2/G)^n/S_n$.  



Stabilization implies that for fixed $\delta$, and large $n$, this second resolution will be bigger than the first resolution.

Changing Stability?
But, it seems as $\delta\to\infty$, this second family of resolutions converges to the first.


\section{Warm-up: Cores, quotients, and $\Z_r\subset SL_2$}

In this section, we discuss the relationship between the classical notion of cores and quotients of partitions and the topology of $\Hilb_v([\C^2/G])$ in the case when $G=\Z_r\subset SL_2$, sometimes called the \emph{anti-diagonal case}.  This relationship is well known to experts, but is somewhat scattered across the literature and not always presented in the form we would like.  As this relationship is the central motivation for our notion of $G$ cores and quotients, we spend much time.







\subsection{Colored boxes}

In the anti-diagonal case, the coloring scheme of the cells is a familiar object in the student of partitions.

\begin{definition}
The \emph{content} $c(\square)$ of a cell $\square=(i,j)\in\lambda$ is $c(\square)=i-j$
\end{definition}

\begin{tikzpicture}

\draw[thin, gray] (0,0) grid (4.5,4.5);
\foreach \x in {0,...,4}
   \foreach \y in {0,...,4}
       \pgfmathsetmacro\result{\x-\y}
       \node at (\x+.5,\y+.5) {\pgfmathprintnumber{\result} };
\node at (10,2.5) {Each cell is labeled by its content};

\end{tikzpicture}

It is immediate from the definition that if we let $\C^*_{1,-1}$ be the torus that acts on $x$ with weight 1 and $y$ with weight $-1$, then the content $c(\square)$ is just the weight of the $\C^*$ action on the corresponding monomial in $R$.

If we work with the antidiagonal $\Z_r$ action, with generator 

Furthermore, the multiset of the contents of $\lambda \mod r$ is just the class of $[R/\II]\in K^0(\Z_r)$.



Combinatorially, it seems awkward that cells with $a(\square)=0$ are included in the negative eigenspace instead of the positive eigenspace, and it is natural to make the following definition:
\begin{definition}
The \emph{combinatorial} positive and negative dimensions, $\cdim^\pm_{k/r}(\lambda)$ are defined by
\begin{align*}
\cdim^+_{k/r}(\lambda)&=\#\left\{\square\in\lambda \Big | \ell(\square)-k a(\square)=-1 \mod r\right\} \\
\cdim^-_{k/r}(\lambda)&=\#\left\{\square\in\lambda \Big | \ell(\square)-k a(\square)=k \mod r\right\} \\
\end{align*}
\end{definition}

\begin{example}[Hook Lengths]
The case when $G\subset SL_2$ is $k=r-1$, or equivalently, $k=-1$.  In this case, we have
$$\cdim^+_{-1/r}(\lambda)=\cdim^-_{-1/r}(\lambda)=\#\left\{\square\in\lambda \Big | h(\square)=0\mod r\right\} \\$$
and so these statistics count the number of cells with hook lengths divisible by $r$.
\end{example}

The generating functions for $\cdim^+_{k/r}$ and $\dim^+_{k/r}$ are closely related.

\begin{lemma}
$$\prod_{m>0}(1-q^{mr}t^m)\sum_{\lambda\in\PP} q^{|\lambda|}t^{\cdim^+_{k/r}(\lambda)}=\prod_{m>0} (1-q^{mr}t^{m-1}) \sum_{\lambda\in\PP} q^{|\lambda|}t^{\dim^+_{k/r}(\lambda)}$$
\end{lemma}
\begin{proof}
The two statistics $\cdim^+_{k/r}$ and $\dim_{k/r}$ both count cells $\square$ satisfying the congruence relation $\ell(\square)-ka(\square)=-1\mod r$; the combinatorial dimension includes those cells with $a(\square)=0$, while the usual dimension does not.  

If a square satifies $a(\square)=0$ it is on the top of its column; when $a(\square)=0$ the congruence relation becomes simply asking that $\ell(\square)+1$ is divisible by $r$. Since $\square$ is at the top of its column, that means the two differ whenever we have a part of $\lambda$ appearing at least $kr$ times.  In particular, the two statistics agree on partitions $\lambda$ where no part has multiplicity $r$ or greater.

If there are $r$ or more parts of size $m$ in $\lambda$, one may remove $r$ parts of them, resulting in removing an $r\times k$ rectangle of squares from $\lambda$.  Doing so will not change $\ell(\square)-ka(\square)\mod r$ for any square in $\lambda$ -- we haven't changed the arm or leg of any square to the right of the rectangle removed, while we have reduced the leg of any square to the right by $r$.  Furthermore, each row of squares we removed will contain exactly one square contributing to $\cdim^+_{k/r}(\lambda)$, since each square in a row has the same arm length, and as we move across the row from right to left the leg lengths decrease by 1.  

Thus, we have seen that if we let $\PP^{<r}$ to denote the set of partitions with multiplicities of all parts less than $r$, we have
$$\prod_{m>0}\frac{1}{1-q^{mr}t^m}\sum_{\lambda\in\PP} q^{|\lambda|}t^{\cdim^+_{k/r}(\lambda)}=\sum_{\lambda\in\PP^{<r}}q^{|\lambda|}t^{\cdim^+_{k/r}(\lambda)}$$
The same analysis holds for $\dim^+_{k/r}$, except now the top row of each rectangle removed does not contribute to $\dim^+$, explaining why the powers of $t$ in the product are one lower.

The shaded cells are the cells contributing to $\cdim^+_{1/3}(\lambda)$; that is, those cells $\square$ with $\ell(\square)-a(\square)=-1\mod 3$.  The regions contained in the dashed red lines correspond to the parts removed -- notice that each row of each region contains one shaded box, and that removing the dashed regions does not changed whether the leftover cells are shaded or not.


\begin{tikzpicture}[scale=.5]
\begin{scope}
\fill[red!20!white] (0,1) rectangle (2,2);
\fill[red!20!white] (2,2) rectangle (3,5);
\fill[red!20!white] (2,1) rectangle (3,0);
\fill[red!20!white] (3,1) rectangle (4,2);
\fill[red!20!white] (4,2) rectangle (5,4);
\fill[red!20!white] (4,0) rectangle (5,1);
\fill[red!20!white] (6,1) rectangle (9,2);
\fill[red!20!white] (9,1) rectangle (10,0);
\fill[red!20!white] (11,1) rectangle (12,2);
\fill[red!20!white] (12,1) rectangle (13,0);
\fill[red!20!white] (16,1) rectangle (17,0);

\draw[thick, dashed, red] (4.1,.1)--(4.1,3.9)--(6.9,3.9)--(6.9,.1)--cycle;
\draw[thick, dashed, red] (8.1,.1)--(8.1,1.9)--(10.9,1.9)--(10.9,.1)--cycle;
\draw[thick, dashed, red] (11.1,.1)--(11.1,1.9)--(13.9,1.9)--(13.9,.1)--cycle;
\draw[thick, dashed, red] (16.1,.1)--(16.1,.9)--(18.9,.9)--(18.9,.1)--cycle;


\path[clip, preaction={thick, draw}] (0,0)--(0,7)--(1,7)--(1,6)--(3,6)--(3,4)--(7,4)--(7,3)--(8,3)--(8,2)--(14,2)--(14,1)--(19,1)--(19,0)--cycle;
\draw[thin, gray] (0,0) grid (20,7);
\end{scope}

\begin{scope}[yshift=-10cm]
\fill[red!20!white] (0,1) rectangle (2,2);
\fill[red!20!white] (2,2) rectangle (3,5);
\fill[red!20!white] (2,1) rectangle (3,0);
\fill[red!20!white] (3,1) rectangle (5,2);


\path[clip, preaction={thick, draw}] (0,0)--(0,7)--(1,7)--(1,6)--(3,6)--(3,4)--(4,4)--(4,3)--(5,3)--(5,1)--(7,1)--(7,0)--cycle;
\draw[thin, gray] (0,0) grid (7,7);
\end{scope}

\end{tikzpicture}
\end{proof}


Combinatorially, our motivation lies in the notion of core partitions.
\begin{definition} \label{def:hooklength}
  Let $\lambda$ be a partition.  The \emph{hook length} $h(\square)$ of $\square\in\lambda$ is $a(\square)+\ell(\square)+1$.
\end{definition}

Comparing Definition \ref{def:hooklength} with Lemma \ref{lem:dimkr}, we have:

\begin{lemma}
$$\dim_{k/r}(\lambda)&=\#\left\{\square\in\lambda \Big | h(\square)=0 \pmod r\right\}$$
\end{lemma}

\begin{definition} \label{def:tcore}
We say $\lambda$ is a \emph{$t$-core} if it has no cells $\square\in\lambda$ with $h(\square)=t$.
\end{definition}

There are many equivalent ways to think about $t$-core partitions; when we generalize them some of these definitions will still hold and some will be different.

\begin{lemma}
The following are equivalent:
\begin{enumerate}
\item $\lambda$ is a $t$-core
\item $\lambda$ has no boundary strips of length $t$
\item $\lambda$ has no cells $\square$ with $t|h(\square)$
\item It is not possible to remove one square of each color from $\lambda$
\item There are no partitions $\mu$ with $|\mu|^{-1/r}=|\lambda|^{-1/r}-\Reg$
\item $|\lambda|^{-1/r}=|\mu|^{-1/r}$ implies $\lambda=\mu$ 
\item $\II_\lambda$ is an isolated point in $\Hilb_n([\C^2/G_{-1/t}])$
\end{enumerate}


\end{lemma}

Some implications between these partitions are immediate: $(3)\implies(1)$

\subsection{Cores, Quotients, and the abacus}

of letters, we will prefer to work with \emph{Maya diagrams}, which we now describe.  The conventions in the following discussion are based on the ``fermionic'' viewpoint of partitions and lattice paths, based on Dirac's electron sea model, see \cite{KR} for more. 


\subsection{Paths}

We use $\Z_{1/2}$ to denote the set of half integers $\Z+1/2$, i.e., $-1/2$ and $3/2$ are in $\Z_{1/2}$, but $2$ is not.  $\Z_{1/2}^+$ will denote the positive half integers, and $\Z_{1/2}^-$ will denote the negative.


\begin{definition}
  A state $S$ is a subset $S\subset \Z^{1/2}$ so that the symmetric difference of $S$ with $\Z^-_{1/2}$ is finite; that is $S\cap\Z^+_{1/2}$ and $S^c\cap \Z^-_{1/2}$ are both finite.  We call the elements of $k\in S\cap \Z^_{1/2}$ an electron of energy $k$, and an element of $\ell\in S^c\cap \Z^-{1/2}$ a positron of energy $-\ell$.  We will identify states as their finite collection of electrons and positrons.  We call $|S\cap \Z^-_{1/2}|-|S\cap \Z^+_{1/2}|$ the \emph{charge} of $S$.
  
We will typically represent a state by a \emph{Maya diagram} -- this is a sequence of circles labeled by $\Z_{1/2}$, with the positive entries going to the left and the negative entries to the right.  A black bead is placed at each of the entries of $S$, and the entries not in $S$ are displayed as white circles.
\end{definition}



\subsubsection{}
The connection between Maya diagrams and partitions is best illustrated by drawing the partitions in ``Russian notation'' -- rotated $\pi/4$ radians counterclockwise and scaled up by a factor of $\sqrt{2}$, so that each segment of the border path of $\lambda$ is centered above a half integer on the $x$-axis, with origin above the square 0.  Given a partition $\lambda$, one then obtains a state $S_\lambda$ as follows: for each $k\in\Z^{1/2}$, there is exactly one segment of the boundary path of $\lambda$.  We put $k\in S_\lambda$ if this boundary segment travels NE, and we put $k\notin S_\lambda$ if this boundary segment goes SE.



\begin{example} \label{ex:electronstopartitions}

We illustrate the bijection in the case of $\lambda=3+2+2$.  The corresponding state $S_\lambda$ consists of two
electrons with energy $5/2$ and $1/2$, and two positrons with energy
$3/2$ and $5/2$.

\begin{center}
\begin{tikzpicture}
\begin{scope}[gray, very thin, scale=.6]
\clip (-5.5, 5.5) rectangle (5.5, -5);
\draw[rotate=45, scale=1.412] (0,0) grid (6,6);
\end{scope}

\begin{scope}[rotate=45, very thick, scale=.6*1.412]
\draw (0,5.5) -- (0, 3) -- (1,3) -- (1,2) -- (3,2) -- (3,0) -- (5.5,0);
\end{scope}

\begin{scope}[scale=.6, dotted]

\draw (-4.5,0) -- (-4.5, 4.5);
\draw (-3.5,0) -- (-3.5, 3.5);
\draw (-2.5,0) -- (-2.5, 3.5);
\draw (-1.5,0) -- (-1.5, 3.5);
\draw (-.5,0) -- (-.5, 3.5);
\draw (.5,0) -- (.5, 4.5);
\draw (1.5,0) -- (1.5, 4.5);
\draw (2.5,0) -- (2.5, 3.5);
\draw (3.5,0) -- (3.5, 3.5);
\draw (4.5,0) -- (4.5, 4.5);
\end{scope}


\begin{scope}[scale=.6, yshift=-.5cm]
\draw[solid] (0,-.5) -- (0,.5);
\draw (-5.5,0) node{$\cdots$};
\draw (-4.5,0) circle (.3) node[below=3pt]{$\frac{9}{2}$};
\draw (-3.5,0) circle (.3) node[below=3pt]{$\frac{7}{2}$};
\filldraw (-2.5,0) circle (.3) node[below=3pt]{$\frac{5}{2}$};
\draw (-1.5,0) circle (.3) node[below=3pt]{$\frac{3}{2}$};
\filldraw (-.5,0) circle (.3) node[below=3pt]{$\frac{1}{2}$};
\filldraw (.5,0) circle (.3) node[below=3pt]{$\frac{-1}{2}$};
\draw (1.5,0) circle (.3) node[below=3pt]{$\frac{-3}{2}$};
\draw (2.5,0) circle (.3) node[below=3pt]{$\frac{-5}{2}$};
\filldraw (3.5,0) circle (.3) node[below=3pt]{$\frac{-7}{2}$};
\filldraw (4.5,0) circle (.3) node[below=3pt]{$\frac{-9}{2}$};
\draw (5.5,0) node{$\cdots$};
\end{scope}
\end{tikzpicture}
\end{center}

\end{example}







The bijection between partitions and states of charge zero may be
modified to give a bijection between partitions and states of charge $c$ for any $c\in\Z$.   Simply translate the partition to the right by $c$.



\subsection{Abaci}

Rather than view the Maya diagram as a series of stones in a line, we
now view it as beads on the runner of an abacus.  Sliding the beads
to be right justified allows the charge of the state to be read off,
as it is easy to see how many electrons have been added or are missing
from the vacuum state.

In what follows, we mix our metaphors and talk about electrons and protons on runners of an abacus.

\begin{example} \label{ex:mayabijection}
Consider Example \ref{ex:particles}, where the Maya diagram consists of
two positrons and an electron.  Pushing the beads to be right
justified, we see the first bead is one step to the right of zero, and
hence the original state had charge 1.

\begin{center}
\begin{tikzpicture}[scale=.6]
\draw (0,-.5) to (0,.5);
\draw (-5.5,0) node{$\cdots$};
\draw (-4.5,0) circle (.3) node[below=3pt]{$\frac{9}{2}$};
\draw (-3.5,0) circle (.3) node[below=3pt]{$\frac{7}{2}$};
\draw (-2.5,0) circle (.3) node[below=3pt]{$\frac{5}{2}$};
\filldraw (-1.5,0) circle (.3) node[below=3pt]{$\frac{3}{2}$};
\draw (-.5,0) circle (.3) node[below=3pt]{$\frac{1}{2}$};
\draw (.5,0) circle (.3) node[below=3pt]{$\frac{-1}{2}$};
\filldraw (1.5,0) circle (.3) node[below=3pt]{$\frac{-3}{2}$};
\draw (2.5,0) circle (.3) node[below=3pt]{$\frac{-5}{2}$};
\filldraw (3.5,0) circle (.3) node[below=3pt]{$\frac{-7}{2}$};
\filldraw (4.5,0) circle (.3) node[below=3pt]{$\frac{-9}{2}$};
\draw (5.5,0) node{$\cdots$};

\begin{scope}[yshift=-2.5cm]
\draw[-triangle 45, snake=snake,line after snake=1mm] (-4,0)--(4,0) node [above,  text centered,midway] {Push beads};

\end{scope}

\begin{scope}[yshift=-4cm]
\draw (0,-.5) to (0,.5);
\draw (-5.5,0) node{$\cdots$};
\draw (-4.5,0) circle (.3) node[below=3pt]{$\frac{9}{2}$};
\draw (-3.5,0) circle (.3) node[below=3pt]{$\frac{7}{2}$};
\draw (-2.5,0) circle (.3) node[below=3pt]{$\frac{5}{2}$};
\draw (-1.5,0) circle (.3) node[below=3pt]{$\frac{3}{2}$};
\draw (-.5,0) circle (.3) node[below=3pt]{$\frac{1}{2}$};
\draw (.5,0) circle (.3) node[below=3pt]{$\frac{-1}{2}$};
\filldraw (1.5,0) circle (.3) node[below=3pt]{$\frac{-3}{2}$};
\filldraw (2.5,0) circle (.3) node[below=3pt]{$\frac{-5}{2}$};
\filldraw (3.5,0) circle (.3) node[below=3pt]{$\frac{-7}{2}$};
\filldraw (4.5,0) circle (.3) node[below=3pt]{$\frac{-9}{2}$};
\draw (5.5,0) node{$\cdots$};
\end{scope}


\end{tikzpicture}
\end{center}
\end{example}

\subsubsection{Cells and hook lengths}

The cells $\square\in\lambda$ are in bijection with the
\emph{inversions} of the boundary path; that is, by pairs of segments
$(\text{step}_1, \text{step}_2)$, where $\text{step}_1$ occurs before $\text{step}_2$,
but $\text{step}_1$ is traveling NE and $\text{step}_2$ is traveing SE.  The bijection
sends $\square$ to the segments at the end of its arm and leg, which we call the \emph{hand} and \emph{foot} of $\square$.

Translating to the fermionic viewpoint, cells of $\lambda$ are in
bijection with pairs 
$$\left\{(e, e-k)\big | e\in\Z_{1/2}, k>0\right\}$$ of a filled energy level $e$ and an unfilled energy level $k$.  


The arm $a(\square)$ corresponds to the number of energy levels between $e$ and $e-k$ that are empty; the leg $\ell(\square)$ is the number of energy levels between $e$ and $e-k$ that are full.  The hook length $h(\square)$ of the corresponding cell is $k$, the distance between the two sets with 

Recall that a \emph{rim hook} of length $a$ of $\lambda$ is a size $a$ subset of the cells of $\lambda$ so that removing the rim hook gives a small partition, and the rim hook does not contain a $2\times 2$ box.  

\begin{lemma} \label{lem:rimhooks}
Rimhooks of size $a$ in $\lambda$ are in bijection with cells $\square\in\lambda$ with $h(\square)=a$.  Removing the rimhook corresponds to moving the stone at $e$ and playing at $e-k$ instead.
\end{lemma}

This is illustrated in the following picture:

\begin{tikzpicture}[scale=.8]
\begin{scope}[gray, very thin, scale=.6]
   \clip (-5.5, 5.5) rectangle (5.5, -1);
   \draw[rotate=45, scale=1.412, fill, red!20!white] (1,1)--(1,2)--(3,2)--(3,0)--(2,0)--(2,1)--cycle;
   \draw[rotate=45, scale=1.412] (0,0) grid (6,6);
\end{scope}
\begin{scope}[rotate=45, very thick, scale=.6*1.412]
   \draw (0,5.5) -- (0, 3) -- (1,3) -- (1,2) -- (3,2) -- (3,0) -- (5.5,0);
\end{scope}
\begin{scope}[scale=.6, yshift=-.5cm]
   \draw (-5.5,0) node{$\cdots$};
   \draw (-4.5,0) circle (.3);
   \draw (-3.5,0) circle (.3);
   \filldraw (-2.5,0) circle (.3);
   \draw (-1.5,0) circle (.3);
   \filldraw[gray] (-.5,0) circle (.3);
   \filldraw (.5,0) circle (.3);
   \draw (1.5,0) circle (.3);
   \draw (2.5,0) circle (.3);
   \filldraw (3.5,0) circle (.3);
   \filldraw (4.5,0) circle (.3);
   \draw (5.5,0) node{$\cdots$};
   \node (start) at (-.3, -.3) {};
   \node(finish) at (2.3, -.3) {};
   \draw[->] (start) to [out=-30, in=210] (finish);
\end{scope}
\begin{scope}[xshift=8cm]
   \begin{scope}[gray, very thin, scale=.6]
      \clip (-5.5, 5.5) rectangle (5.5, -1);
      \draw[rotate=45, scale=1.412] (0,0) grid (6,6);
   \end{scope}
   \begin{scope}[rotate=45, very thick, scale=.6*1.412]
      \draw (0,5.5) -- (0, 3) -- (1,3) -- (1,1) -- (2,1) -- (2,0) -- (5.5,0);
   \end{scope}
   \begin{scope}[scale=.6, yshift=-.5cm]
      \draw (-5.5,0) node{$\cdots$};
      \draw (-4.5,0) circle (.3);
      \draw (-3.5,0) circle (.3);
      \filldraw (-2.5,0) circle (.3);
      \draw (-1.5,0) circle (.3);
      \draw (-.5,0) circle (.3);
      \filldraw (.5,0) circle (.3);
      \draw (1.5,0) circle (.3);
      \filldraw (2.5,0) circle (.3);
      \filldraw (3.5,0) circle (.3);
      \filldraw (4.5,0) circle (.3);
      \draw (5.5,0) node{$\cdots$};
   \end{scope}
\end{scope}
\end{tikzpicture}


The classical definition of the $r$-core of a partition $\lambda$ is as follows.

\begin{definition} 
The $r$-core of $\lambda$, denoted $\core_r(\lambda)$, the partition obtained from $\lambda$ by iteratively choosing a rim-hook of size $r$ in $\lambda$ and removing it, until we reach a partition with no rim-hooks of size $r$.
\end{definition}

It is not clear from the above definition that $\core_r(\lambda)$ is well defined -- it seems possible that removing rim hooks in different orders could result in different partitions.  



\begin{example}
The cell $\square=(2,1)$ of $\lambda=3+2+2$ (See Example \ref{ex:electronstopartitions}).
Here, $h(\square)=3$, and corresponds to the electron in energy state $1/2$
and the empty energy level $-5/2$; which are three apart.

\end{example}

\subsection{Bijections}

The essence of the cores and quotient construction is that, rather than place the electrons corresponding to $\lambda$ on one runner, we place them on $r$ different runners, putting the energy levels $ka-i-1/2$ on runner $i$ -- i.e., every $r$th bead goes to the same runner, as in Figure \ref{ }

The charge $c_i$ on the $i$th runner need not be 0, but using the change, we may still view the beads on the $i$th runner as a Maya diagram of a partition.  


\begin{definition} \label{def:quotients}
The \emph{$r$-quotient} of $\lambda$, denoted $\quot_r(\lambda)$ is an $r$-tuple of partitions, where the $i$th partition $\quot_r^i(\lambda)$ is obtained by reading off the $i$th runner of the $r$-abacus of $\lambda$ as a partition.

The size of the $r$-quotient is the sum of the sizes of the individual partitions: 
$$|\quot_r(\lambda)|=\sum_{i=1}^r |\quot_r^i(\lambda)|$$
\end{definition}

The abacus construction also gives us another way to view the $r$-core of a partition $\lambda$.  Since removing an $r$-border strip corresponds to moving a bead $r$ spots to the right to an empty position, on the $r$ abacus this corresponds to moving a bead one step to the right on its runner.  Thus, 


\begin{lemma}
We have
$$|\lambda|=|\core_r{\lambda}|+r|\quot_r{\lambda}|$$
$$\cdim^+_{-1/r}(\lambda)=|\quot_r{\lambda}|$$
\end{lemma}

\begin{proof}
To form the core of $\lambda$ from $\lambda$, we slide the beads on each runner of the abacus.  Each time we slide a bead one step, we are removing an $r$-strip from $\lambda$, and hence decreasing the size of $\lambda$ by one.  On the other hand, we are removing a single cell from $\tilde{\lambda}$.


\end{proof}


\begin{corollary} \label{cor:product-formulas-traditional-cores}

Let $\mathcal{C}_r$ denote the set of $r$-core partitions.  We have
$$\sum_{\lambda\in\mathcal{C}_a} q^{|\lambda|}=\frac{(q^r;q^r)_\infty^r}{(q;q)_\infty}$$
Moreover, we have 
$$\sum_{\lambda\in\mathcal{P}} q^{|\lambda|} t^{\cdim^+{-1/r}(\lambda)}=\frac{(q^r;q^r)_\infty^r}{(q;q)_\infty}\frac{1}{(q^rt;q^rt)_\infty^r}$$
And hence:
$$P_t(\Hilb_{[\C^2/G]})=\frac{(q^r;q^r)_\infty^r}{(q;q)_\infty}\frac{1}{(q^rt^2;q^rt^2)_\infty^{r-1}(q^r;q^rt^2)_\infty}$$
\end{corollary}





The process is reversible -- if we have $a$-different Maya diagrams whose charge sums to $0$, we may interleave the beads of them together as in Figure \ref{ }, and merge them to get a partition.  


The $a$-quotient of $\lambda$ records information about the $a$-hooks of $\lambda$.  If we have a cell $\square\in\lambda$,  with hooklength $h(\square)=ka$ divisible by $a$, then the two energy levels of $\textrm{inversion}(\square)$ lie on the same runner.  Similarly, any inversion of energy states on the same runner corresponds to a cell with hook length divisible by $a$.  

Thus, $\lambda$ is an $a$-core if and only if the beads on each runner of the $a$-abacus are right justified, that is, if the $a$-quotient of $\lambda$ is zero.  Moving a bead on the $a$-abacus, corresponds to removing a border strip of length $a$, and so sliding all the beads on each runner all the way to the right corresponds to removing all $a$-hooks in $\lambda$.  We see that the order we make the moves doesn't matter, as the end result will always be the same.

  Although the total charge of all the runners must be zero, the charge need not be evenly divided among the runners.  Let
$c_i$ be the charge on the $i$th runner; then we have $\sum c_i=0$, and the $c_i$ determine $\lambda$.

Similarly, given any $\mathbf{c}=(c_0,\dots,c_{a-1})\in\Z^a$ with $\sum c_i=0$, there is a unique right justified abacus with charge  $c_i$ on the $i$th runner.  The coresponding partition is an $a$-core which we denote $\core_a(\mathbf{c})$.

We have shown:

\begin{lemma}
There is a bijection $$\core_a:\{(c_0,\dots,c_{a-1}|c_i\in\Z, \sum c_i=0\}\to \{\lambda | \lambda \text{ is in $a$-core} \}$$
\end{lemma}


\begin{example}
We illustrate that $\core_3(0,3, -3)=7+5+3+3+2+2+1+1$.  The numbers on the boundary path illustrate which runner of the abacus that step belongs to.

\begin{center}
\begin{tikzpicture}

\begin{scope} %drawing of original partition
\draw (0,5) node{$\lambda=10+8+8+4+4+3+1+1$};


   \begin{scope}[gray, very thin, scale=.4]
      \clip (-11.5, 11.5) rectangle (11.5, -1);
      \draw[rotate=45, scale=1.412, gray!20!white, fill] (0,0)--(0,10)--(1,10)--(1,8)--(3,8)--(3,4)--(5,4)--(5,3)--(6,3)--(6,1)--(8,1)--(8,0)--cycle;
      \begin{scope}[rotate=45, scale=1.412, black!50!green] 
         \draw (.5,6.5)node{$\spadesuit$};
         \draw (1.5,6.5)node{$\spadesuit$};
      \end{scope}

      \begin{scope}[rotate=45, scale=1.412, blue] 
         \draw (2.5,5.5)node{$\clubsuit$};
         \draw (2.5,2.5)node{$\clubsuit$};
         \draw (4.5,2.5)node{$\clubsuit$};
      \end{scope}


      \draw[rotate=45, scale=1.412] (0,0) grid (12,12);
   \end{scope}

   \begin{scope}[rotate=45, ultra thick, scale=.4*1.412]
      \begin{scope}[blue]
         \draw (1,9.5) node{$1$};
         \draw (2.5,8)node{$1$};
         \draw (3,5.5)node{$1$};
         \draw (4.5,4)node{$1$};
         \draw (6,2.5)node{$1$};
         \draw (7.5,1)node{$1$};
         \draw (9.5,0)node{$1$};
      \end{scope}

      \begin{scope}[red]
         \draw (0,10.5)node{$2$};
         \draw (1,8.5)node{$2$};
         \draw (3,7.5)node{$2$};
         \draw (3,4.5)node{$2$};
         \draw (5,3.5)node{$2$};
         \draw (6,1.5)node{$2$};
         \draw (8,.5)node{$2$};
         \draw (10.5,0)node{$2$};
      \end{scope}

      \begin{scope}[black!50!green]
         \draw (.5,10)node{$3$};
         \draw (1.5, 8)node{$3$};
         \draw (3,6.5)node{$3$};
         \draw (3.5,4)node{$3$};
         \draw (5.5,3)node{$3$};
         \draw (6.5,1)node{$3$};
         \draw (8.5,0)node{$3$};
      \end{scope}

   \end{scope}

   \begin{scope}[scale=.4, yshift=-.5cm, blue]
      \draw(-11.5,0) circle(.3);
      \draw(-8.5, 0)  circle (.3);
      \filldraw(-5.5,0)  circle (.3);
      \draw(-2.5,0)  circle (.3);
      \filldraw(.5,0)  circle (.3);
      \draw(3.5,0)  circle (.3);
      \filldraw(6.5,0)  circle (.3);
      \filldraw(9.5,0)  circle (.3);
   \end{scope}

   \begin{scope}[scale=.4, yshift=-1.5cm, red]
      \draw(-10.5,0) circle(.3);
      \draw(-7.5, 0)  circle (.3);
      \draw(-4.5,0)  circle (.3);
      \draw(-1.5,0)  circle (.3);
      \draw(1.5,0)  circle (.3);
      \draw(4.5,0)  circle (.3);
      \draw(7.5,0)  circle (.3);
      \filldraw(10.5,0)  circle (.3);
   \end{scope}

   \begin{scope}[scale=.4, yshift=-2.5cm, black!50!green]
      \filldraw(-9.5,0) circle(.3);
      \filldraw(-6.5, 0)  circle (.3);
      \draw(-3.5,0)  circle (.3);
      \filldraw(-.5,0)  circle (.3);
      \filldraw(2.5,0)  circle (.3);
      \filldraw(5.5,0)  circle (.3);
      \filldraw(8.5,0)  circle (.3);
      \filldraw(11.5,0)  circle (.3);
   \end{scope}

   \begin{scope}[scale=.4]
      \draw (0,-3)--(0,0);
   \end{scope}
\end{scope}

\begin{scope}[yshift=-8cm] %drawing of the core
\draw (0,5) node{$\core_3(\lambda)=7+5+3+3+2+2+1+1$};


   \begin{scope}[gray, very thin, scale=.4]
      \clip (-11.5, 11.5) rectangle (11.5, -1);
      \draw[rotate=45, scale=1.412, gray!20!white, fill] (0,0)--(0,7)--(1,7)--(1,5)--(2,5)--(2,3)--(4,3)--(4,2)--(6,2)--(6,1)--(8,1)--(8,0)--cycle;
      \draw[rotate=45, scale=1.412] (0,0) grid (12,12);
   \end{scope}

   \begin{scope}[rotate=45, ultra thick, scale=.4*1.412]
      \begin{scope}[blue]
         \draw (0,8.5) node{$1$};
         \draw (1,6.5)node{$1$};
         \draw (2,4.5)node{$1$};
         \draw (3.5,3)node{$1$};
         \draw (5.5,2)node{$1$};
         \draw (7.5,1)node{$1$};
         \draw (9.5,0)node{$1$};
      \end{scope}

      \begin{scope}[red]
         \draw (0,10.5)node{$2$};
         \draw (0,7.5)node{$2$};
         \draw (1,5.5)node{$2$};
         \draw (2,3.5)node{$2$};
         \draw (4,2.5)node{$2$};
         \draw (6,1.5)node{$2$};
         \draw (8,.5)node{$2$};
         \draw (10.5,0)node{$2$};
      \end{scope}

      \begin{scope}[black!50!green]
         \draw (0,9.5)node{$3$};
         \draw (0.5, 7)node{$3$};
         \draw (0.5,7)node{$3$};
         \draw (1.5,5)node{$3$};
         \draw (2.5,3)node{$3$};
         \draw (4.5,2)node{$3$};
         \draw (6.5,1)node{$3$};
         \draw (8.5,0)node{$3$};
      \end{scope}

   \end{scope}

   \begin{scope}[scale=.4, yshift=-.5cm, blue]
      \draw(-11.5,0) circle(.3);
      \draw(-8.5, 0)  circle (.3);
      \draw(-5.5,0)  circle (.3);
      \draw(-2.5,0)  circle (.3);
      \filldraw(.5,0)  circle (.3);
      \filldraw(3.5,0)  circle (.3);
      \filldraw(6.5,0)  circle (.3);
      \filldraw(9.5,0)  circle (.3);
   \end{scope}

   \begin{scope}[scale=.4, yshift=-1.5cm, red]
      \draw(-10.5,0) circle(.3);
      \draw(-7.5, 0)  circle (.3);
      \draw(-4.5,0)  circle (.3);
      \draw(-1.5,0)  circle (.3);
      \draw(1.5,0)  circle (.3);
      \draw(4.5,0)  circle (.3);
      \draw(7.5,0)  circle (.3);
      \filldraw(10.5,0)  circle (.3);
   \end{scope}

   \begin{scope}[scale=.4, yshift=-2.5cm, black!50!green]
      \draw(-9.5,0) circle(.3);
      \filldraw(-6.5, 0)  circle (.3);
      \filldraw(-3.5,0)  circle (.3);
      \filldraw(-.5,0)  circle (.3);
      \filldraw(2.5,0)  circle (.3);
      \filldraw(5.5,0)  circle (.3);
      \filldraw(8.5,0)  circle (.3);
      \filldraw(11.5,0)  circle (.3);
   \end{scope}

   \begin{scope}[scale=.4]
      \draw (0,-3)--(0,0);
   \end{scope}

\end{scope}


\begin{scope}[yshift=-12cm] %the quotients

   \begin{scope}[xshift=-4cm] %blue quotient


\draw (0,2) node{$\quot_3^1(\lambda)=2+1$};
      \begin{scope}[gray, very thin, scale=.4]
         \clip (-5, 3.5) rectangle (5, -1);
         \draw[rotate=45, scale=1.412, gray!20!white, fill] (0,0)--(0,2)--(1,2)--(1,1)--(2,1)--(2,0)--cycle;
         \draw[rotate=45, scale=1.412] (0,0) grid (4,4);
      \end{scope}

      \begin{scope}[scale=.4, yshift=-.5cm, blue]
         \draw(-3.5,0) circle(.3);
         \draw(-2.5, 0)  circle (.3);
         \filldraw(-1.5,0)  circle (.3);
         \draw(-.5,0)  circle (.3);
         \filldraw(.5,0)  circle (.3);
         \draw(1.5,0)  circle (.3);
         \filldraw(2.5,0)  circle (.3);
         \filldraw(3.5,0)  circle (.3);
      \end{scope}

   \end{scope}



   \begin{scope} %red quotient
\draw (0,2) node{$\quot_3^2(\lambda)=\emptyset$};
      \begin{scope}[gray, very thin, scale=.4]
         \clip (-5, 3.5) rectangle (5, -1);
         \draw[rotate=45, scale=1.412] (0,0) grid (4,4);
      \end{scope}

      \begin{scope}[scale=.4, yshift=-.5cm, red]
         \draw(-3.5,0) circle(.3);
         \draw(-2.5, 0)  circle (.3);
         \draw(-1.5,0)  circle (.3);
         \draw(-.5,0)  circle (.3);
         \filldraw(.5,0)  circle (.3);
         \filldraw(1.5,0)  circle (.3);
         \filldraw(2.5,0)  circle (.3);
         \filldraw(3.5,0)  circle (.3);
      \end{scope}

   \end{scope}


   \begin{scope}[xshift=4cm] %green quotient 
\draw (0,2) node{$\quot_3^3(\lambda)=1+1$};

      \begin{scope}[gray, very thin, scale=.4]
         \clip (-5, 3.5) rectangle (5, -1);
         \draw[rotate=45, scale=1.412, gray!20!white, fill] (0,0)--(0,1)--(2,1)--(2,0)--cycle;
         \draw[rotate=45, scale=1.412] (0,0) grid (4,4);
      \end{scope}

      \begin{scope}[scale=.4, yshift=-.5cm, black!50!green]
         \draw(-3.5,0) circle(.3);
         \draw(-2.5, 0)  circle (.3);
         \draw(-1.5,0)  circle (.3);
         \filldraw(-.5,0)  circle (.3);
         \filldraw(.5,0)  circle (.3);
         \draw(1.5,0)  circle (.3);
         \filldraw(2.5,0)  circle (.3);
         \filldraw(3.5,0)  circle (.3);
      \end{scope}

   \end{scope}

\end{scope}


\end{tikzpicture}
\end{center}
\end{example}



\subsection{Leaving and arriving word description}

We now describe a slight shift in perspective on cores that will help when we generalize them.  One way to label the colors of the paths is in terms of the contents of the cells they border.  



\subsection{Size of an \texorpdfstring{$a$}{a}-core}
The core and quotient bijection above in particular gives a bijection between $a$-cores and points in a lattice $a-1$ dimensional lattice.  We have parametrized the lattice above in the \emph{charge} coordinates.  


\begin{definition}
The \emph{$r$-charge} of a partition $\lambda$ is the $c^G(\lambda)$ vector in $\Lambda_a=\{(c_i)|\sum c_i=0\}$ where $c_i^G(\lambda)$ is the charge of the $i$th runner of $\lambda$ when written on the $a$-abacus.
\end{definition}




\begin{theorem} \label{thm:quadratic-sl2}
The size of a core is a quadratic function in the charge coordinates;
$$|\core_a(\mathbf{c})|=\frac{a}{2}\sum_{k=0}^{a-1} c_k^2+ kc_k$$
In fact, each colored cell count is a quadratic function in the charge coordinates.
$$|\core_a(\mathbf{c})|^G_i=\frac{1}{2}\sum_{k=0}^{a-1} c_k^2+ \sum_{k>i}c_k$$
\end{theorem}

We are not sure where Theorem \ref{thm:quadratic-sl2} originates; it is proved independently in \cite{GKS, DS}.  The proof is not difficult and uses the interaction of Frobenius coordinates and the abacus, see ; the first statement is proved in \cite{jsimultaneous} and is easily extended to the second statement. 


Note that since the quadratic part of $|\core_a(\mathbf{c})|^G_i$ is independent of $i$, the quadratic part is adding a number of copies of the regular representation.  Hence, Theorem \ref{thm:quadratic-sl2} implies:




\begin{corollary} 
There is a linear relation between the charge functions $c_i(\lambda)$ the class $[\lambda]^G$.
\end{corollary}

In fact, an explicit form of this linear change of variables will hold in general, even though



 that there is a linear change of variables between the charge coordinates and the colored box coordinates.  This second fact we will prove this second fact directly in Theorem \ref{ }





\section{Generalized cores and applications}

This section introduces \emph{rational cores and quotients}, amd applies them to the study of $|\lambda|_G$ and $\cdim(\lambda)$.  In particular, we prove two results: the topology of $\Hilb_v$ stabilizes, and that the size of $k/r$-cores is piecewise quadratic.

The basic construction of $k/r$-cores and quotients is the $k/r$-abacus.  This parallels the usual abacus construction of regular cores and quotients, but is more complicated: rather than regularly cycling through the $r$ runners, the runners the electrons/beads are placed on depends on whether the previous state was filled with an electron or left empty.  

The construction is also essentially the arriving/departing word construction of \cite{LW}.  We begin by making this explicit, and explaining usual $r$-cores in terms of leaving words.


\subsection{The regular abacus in terms of leaving words} \label{sec:leaving-words}

To conne




The construction of $G$-cores and quotients is exactly parallel to the 


\begin{center}
\begin{tikzpicture}

\begin{scope} %drawing of original partition
\draw (0,5) node{$\lambda=$};
\begin{scope}[scale=.4]

\begin{scope}[rotate=45, scale=1.412]
\clip (0,0)--(13,0)--(0,13)--cycle;
\foreach \x in {0,...,13}{%
    \foreach \y in {0,...,4}{%
       \draw[fill=green!7]  (\x, -\x+3*\y) rectangle (\x+1, -\x+3*\y+1); 
       \draw[fill=blue!7]  (\x, -\x+3*\y+1) rectangle (\x+1, -\x+3*\y+2); 
       \draw[fill=red!7]  (\x, -\x+3*\y+2) rectangle (\x+1, -\x+3*\y+3); 

}}

\begin{scope}
    \clip (0,0)--(0,10)--(1,10)--(1,9)--(3,9)--(3,5)--(4,5)--(4,3)--(6,3)--(6,2)--(7,2)--(7,1)--(8,1)--(8,0)--cycle;
\foreach \x in {0,...,13}{%
    \foreach \y in {0,...,4}{%
       \draw[fill=green!23]  (\x, -\x+3*\y) rectangle (\x+1, -\x+3*\y+1); 
       \draw[fill=blue!23]  (\x, -\x+3*\y+1) rectangle (\x+1, -\x+3*\y+2); 
       \draw[fill=red!23]  (\x, -\x+3*\y+2) rectangle (\x+1, -\x+3*\y+3); 

}}
\end{scope}


      \draw[gray, very thin] (0,0) grid (13,13);
\end{scope}


      \begin{scope}[rotate=45, scale=1.412, black!50!green] 
         \draw (.5,6.5)node{$\spadesuit$};
         \draw (1.5,6.5)node{$\spadesuit$};
      \end{scope}

      \begin{scope}[rotate=45, scale=1.412, blue] 
         \draw (2.5,7.5)node{$\clubsuit$};
         \draw (2.5,3.5)node{$\clubsuit$};
         \draw (3.5,3.5)node{$\clubsuit$};
      \end{scope}



   \end{scope}

   \begin{scope}[rotate=45, ultra thick, scale=.4*1.412]
      \begin{scope}[blue]
         \draw (0,10.5) node{$1$};
         \draw (1,9.5)node{$1$};
         \draw (2.5,9)node{$1$};
         \draw (3,7.5)node{$1$};
         \draw (3.5,5)node{$1$};
         \draw (4,3.5)node{$1$};
         \draw (5.5,3)node{$1$};
         \draw (6.5,2)node{$1$};
         \draw (7.5,1)node{$1$};
         \draw (8.5,0)node{$1$};
         \draw (11.5,0)node{$1$};
      \end{scope}

      \begin{scope}[red]
         \draw (0,11.5)node{$2$};
         \draw (3,8.5)node{$2$};
         \draw (3,5.5)node{$2$};
         \draw (4,4.5)node{$2$};
         \draw (6,2.5)node{$2$};
         \draw (7,1.5)node{$2$};
         \draw (8,.5)node{$2$};
         \draw (9.5,0)node{$2$};
      \end{scope}

      \begin{scope}[black!50!green]
         \draw (.5,10)node{$3$};
         \draw (1.5, 9)node{$3$};
         \draw (3,6.5)node{$3$};
         \draw (4.5,3)node{$3$};
         \draw (10.5,0)node{$3$};

      \end{scope}

   \end{scope}

   \begin{scope}[scale=.4, yshift=-.5cm, blue]
      \draw(-10.5,0) circle(.3);
      \draw(-8.5, 0)  circle (.3);
      \filldraw(-6.5,0)  circle (.3);
      \draw(-4.5,0)  circle (.3);
      \filldraw(-1.5,0)  circle (.3);
      \draw(.5,0)  circle (.3);
      \filldraw(2.5,0)  circle (.3);
      \filldraw(4.5,0)  circle (.3);
      \filldraw(6.5,0)  circle (.3);
      \filldraw(8.5,0)  circle (.3);
      \filldraw(11.5,0)  circle (.3);
   \end{scope}

   \begin{scope}[scale=.4, yshift=-1.5cm, red]
      \draw(-11.5,0) circle(.3);
      \draw(-5.5, 0)  circle (.3);
      \draw(-2.5,0)  circle (.3);
      \draw(-.5,0)  circle (.3);
      \draw(3.5,0)  circle (.3);
      \draw(5.5,0)  circle (.3);
      \draw(7.5,0)  circle (.3);
      \filldraw(9.5,0)  circle (.3);
      \filldraw(12.5,0)  circle (.3);
   \end{scope}

   \begin{scope}[scale=.4, yshift=-2.5cm, black!50!green]
      \draw(-12.5,0)  circle (.3);
      \filldraw(-9.5,0) circle(.3);
      \filldraw(-7.5, 0)  circle (.3);
      \draw(-3.5,0)  circle (.3);
      \filldraw(1.5,0)  circle (.3);
      \filldraw(10.5,0)  circle (.3);
   \end{scope}

   \begin{scope}[scale=.4]
      \draw (0,-3)--(0,0);
   \end{scope}
\end{scope}

\begin{scope}[yshift=-8cm] %drawing of the core
\draw (0,5) node{$\core_3(\lambda)=7+5+3+3+2+2+1+1$};



\begin{scope}[rotate=45, scale=.4*1.412]

\clip (0,0)--(13,0)--(0,13)--cycle;
\foreach \x in {0,...,13}{%
    \foreach \y in {0,...,4}{%
       \draw[fill=green!7]  (\x, -\x+3*\y) rectangle (\x+1, -\x+3*\y+1); 
       \draw[fill=blue!7]  (\x, -\x+3*\y+1) rectangle (\x+1, -\x+3*\y+2); 
       \draw[fill=red!7]  (\x, -\x+3*\y+2) rectangle (\x+1, -\x+3*\y+3); 
}}

\begin{scope}
    \clip (0,0)--(0,7)--(1,7)--(1,6)--(2,6)--(2,5)--(4,5)--(4,4)--(5,4)--(5,3)--(6,3)--(6,2)--(7,2)--(7,1)--(8,1)--(8,0)--cycle;
\foreach \x in {0,...,13}{%
    \foreach \y in {0,...,4}{%
       \draw[fill=green!23]  (\x, -\x+3*\y) rectangle (\x+1, -\x+3*\y+1); 
       \draw[fill=blue!23]  (\x, -\x+3*\y+1) rectangle (\x+1, -\x+3*\y+2); 
       \draw[fill=red!23]  (\x, -\x+3*\y+2) rectangle (\x+1, -\x+3*\y+3); 
}}
\end{scope}


      \draw[gray, very thin] (0,0) grid (13,13);
\end{scope}


   \begin{scope}[rotate=45, ultra thick, scale=.4*1.412]
      \begin{scope}[blue]
         \draw (0,10.5) node{$1$};
         \draw (0,7.5)node{$1$};
         \draw (1,6.5)node{$1$};
         \draw (2,5.5)node{$1$};
         \draw (3.5,5)node{$1$};
         \draw (4.5,4)node{$1$};
         \draw (5.5,3)node{$1$};
         \draw (6.5,2)node{$1$};
         \filldraw (7.5,1)node{$1$};
         \filldraw (8.5,0)node{$1$};
         \filldraw (11.5,0)node{$1$};
      \end{scope}

      \begin{scope}[red]
         \draw (0,11.5)node{$2$};
         \draw (0,8.5)node{$2$};
         \draw (4, 4.5)node{$2$};
         \draw (5, 3.5)node{$2$};
         \draw (6, 2.5)node{$2$};
         \draw (7, 1.5)node{$2$};
         \draw (8,.5)node{$2$};
         \draw (9.5,0)node{$2$};
      \end{scope}

      \begin{scope}[black!50!green]
         \draw (0,9.5)node{$3$};
         \draw (0.5, 7)node{$3$};
         \draw (1.5,6)node{$3$};
         \draw (2.5,5)node{$3$};
         \draw (10.5,0)node{$3$};
      \end{scope}

   \end{scope}

   \begin{scope}[scale=.4, yshift=-.5cm, blue]
      \draw(-10.5,0) circle(.3);
      \draw(-7.5, 0)  circle (.3);
      \draw(-5.5,0)  circle (.3);
      \draw(-3.5,0)  circle (.3);
      \filldraw(-1.5,0)  circle (.3);
      \filldraw(.5,0)  circle (.3);
      \filldraw(2.5,0)  circle (.3);
      \filldraw(4.5,0)  circle (.3);
      \filldraw(6.5,0)  circle (.3);
      \filldraw(8.5,0)  circle (.3);
      \filldraw(11.5,0)  circle (.3);
   \end{scope}

   \begin{scope}[scale=.4, yshift=-1.5cm, red]
      \draw(-11.5,0) circle(.3);
      \draw(-8.5, 0)  circle (.3);
      \draw(-.5,0)  circle (.3);
      \draw(1.5,0)  circle (.3);
      \draw(3.5,0)  circle (.3);
      \draw(5.5,0)  circle (.3);
      \draw(7.5,0)  circle (.3);
      \filldraw(9.5,0)  circle (.3);
      \filldraw(12.5,0)  circle (.3);
   \end{scope}

   \begin{scope}[scale=.4, yshift=-2.5cm, black!50!green]
          \draw(-12.5,0) circle(.3);
      \draw(-9.5,0) circle(.3);
      \filldraw(-6.5, 0)  circle (.3);
      \filldraw(-4.5,0)  circle (.3);
      \filldraw(-2.5,0)  circle (.3);
       \filldraw(10.5,0)  circle (.3);
   \end{scope}

   \begin{scope}[scale=.4]
      \draw (0,-3)--(0,0);
   \end{scope}

\end{scope}


\begin{scope}[yshift=-12cm] %the quotients

   \begin{scope}[xshift=-4cm] %blue quotient


\draw (0,2) node{$\quot_3^1(\lambda)=2+1$};
      \begin{scope}[gray, very thin, scale=.4]
         \clip (-5, 3.5) rectangle (5, -1);
         \draw[rotate=45, scale=1.412, gray!20!white, fill] (0,0)--(0,2)--(1,2)--(1,1)--(2,1)--(2,0)--cycle;
         \draw[rotate=45, scale=1.412] (0,0) grid (4,4);
      \end{scope}

      \begin{scope}[scale=.4, yshift=-.5cm, blue]
         \draw(-3.5,0) circle(.3);
         \draw(-2.5, 0)  circle (.3);
         \filldraw(-1.5,0)  circle (.3);
         \draw(-.5,0)  circle (.3);
         \filldraw(.5,0)  circle (.3);
         \draw(1.5,0)  circle (.3);
         \filldraw(2.5,0)  circle (.3);
         \filldraw(3.5,0)  circle (.3);
      \end{scope}

   \end{scope}



   \begin{scope} %red quotient
\draw (0,2) node{$\quot_3^2(\lambda)=\emptyset$};
      \begin{scope}[gray, very thin, scale=.4]
         \clip (-5, 3.5) rectangle (5, -1);
         \draw[rotate=45, scale=1.412] (0,0) grid (4,4);
      \end{scope}

      \begin{scope}[scale=.4, yshift=-.5cm, red]
         \draw(-3.5,0) circle(.3);
         \draw(-2.5, 0)  circle (.3);
         \draw(-1.5,0)  circle (.3);
         \draw(-.5,0)  circle (.3);
         \filldraw(.5,0)  circle (.3);
         \filldraw(1.5,0)  circle (.3);
         \filldraw(2.5,0)  circle (.3);
         \filldraw(3.5,0)  circle (.3);
      \end{scope}

   \end{scope}


   \begin{scope}[xshift=4cm] %green quotient 
\draw (0,2) node{$\quot_3^3(\lambda)=1+1$};

      \begin{scope}[gray, very thin, scale=.4]
         \clip (-5, 3.5) rectangle (5, -1);
         \draw[rotate=45, scale=1.412, gray!20!white, fill] (0,0)--(0,1)--(2,1)--(2,0)--cycle;
         \draw[rotate=45, scale=1.412] (0,0) grid (4,4);
      \end{scope}

      \begin{scope}[scale=.4, yshift=-.5cm, black!50!green]
         \draw(-3.5,0) circle(.3);
         \draw(-2.5, 0)  circle (.3);
         \draw(-1.5,0)  circle (.3);
         \filldraw(-.5,0)  circle (.3);
         \filldraw(.5,0)  circle (.3);
         \draw(1.5,0)  circle (.3);
         \filldraw(2.5,0)  circle (.3);
         \filldraw(3.5,0)  circle (.3);
      \end{scope}

   \end{scope}

\end{scope}


\end{tikzpicture}
\end{center}



\begin{lemma}
  The map class $[\lambda]^G\in\overline{K}(G)$ depends only on $c^G(\lambda)$.  
More specifically, let $e_i$ be the vector that adds 1 to the $i$th charge, $w_i=e_{i+a}-e_i\in\Lambda^G$ and $f_i\in\overline{K}(G)$ the vector that adds 1 to the $i$th color, and define an isomorphism of lattices $\varphi:\Lambda^G\to\overline{K}(G)$ by $\varphi(w_i)=f_i$.

Then $[\lambda]^G=\varphi(c^G(\lambda))$.
\end{lemma}

\begin{proof}
First, note $\varphi$ is an isomorphism of lattices, as the $w_i$ and $f_i$ generate each lattice subject to the relation $\sum w_i=0, \sum f_i=0$.

It suffices to show that if $\mu$ is obtained from $\lambda$ by removing a single box $\square$, then $[\lambda]^G-[\mu]^G=\varphi(c^G(\lambda)-c^G(\mu)$.  Suppose that $\square$ had color $i$; then in $\lambda$ the border path travels above $\square$ and has color $i$, while in $\mu$ the border path travels below $\square$ and has color $i+a$.  All other up-sloping steps of $\lambda$ and $\mu$ agree.  In removing the box, we deleted a box of color $i$ from $\lambda$, and thus $[\lambda]^G-[\mu]^G=f_i$.  We also removed one bead from the $i$th runner, increasing $c^G_i$ by 1, and added a bead to the $i+a$ runner, decreasing $c^G_{i+a}$ by 1.


\end{proof}


\begin{proposition} \label{prop:connected}
If $G$ is abelian, and $v$ any representation of $G$, then $\Hilb_v([\C^2/G])$ is connected.  
\end{proposition}
\begin{proof}

\end{proof}
For $G=\C^*$, this Theorem was proven by Evain \cite{evain1}.


\section{Riemann-Roch calculation}

In this section we use some more sophisticated algebraic geometric machinery.  However, since we are just working in ; we have attempted to give some background to make this section understandable to those who are not algebraic geometric geometers.

Since $\C^2$ is only quasiprojective (not compact), for everything to be nice in what follows we will want to restrict to objects with compact support.  Since we are interested in moduli spaces of points, our objects will in fact all have support a finite set, and so this is not a real issue.



\subsection{Riemann-Roch Theorem}
Although the ext groups $\Ext^i(\mathcal{F},\mathcal{G})$ between two sheaves depend delicately on the sheaves involved, the Euler pairing
$$\chi(\mathcal{F},\mathcal{G})=\sum_{i\geq 0} \Ext^i(\mathcal{F},\mathcal{G})$$
only depends upon the $K$-theory classes of $\mathcal{F}$ and $\mathcal{G}$.  

\begin{example}
Let $p$ and $q$ be two points of $\C^2$.  If $p\neq q$, then the structure sheaves $\mathcal{O}_p$ and $\mathcal{O}_q$ have disjoint support, and so $\Ext^i(\mathcal{O}_p,\mathcal{O}_q)=0$ for all $i$.

If $p=q$ we have:
\begin{eqnarray*}
\Ext^0(\mathcal{O}_p,\mathcal{O}_p)&=&1\\
\Ext^1(\mathcal{O}_p,\mathcal{O}_p)&=&2\\
\Ext^2(\mathcal{O}_p,\mathcal{O}_p)&=&1 
\end{eqnarray*}

In both cases, $\chi(\mathcal{O}_p,\mathcal{O}_q)=0$.
\end{example}

The Riemann-Roch formula gives an evaluation of the Euler pairing strictly in terms of the $K$-theory classes of the sheaves involved.  Since our orbifolds are global quotients we can just use an equivariant Riemann-Roch formula, and since there are isolated fixed points it has a particularly nice form,  $K^0([\C^2/G])$ will just be representations of $G$.


It is convenient to work in the \emph{super}-category, which simply means to introduce a $\Z_2$ grading.  If $V$ is a super representation, we define $\dim V=\dim V_0-\dim V_1$.

\begin{example} 
The exterior algebra $\bigwedge^*\C^2$ is a super $G$ representation, with $\bigwedge^0\C^2$ and $\bigwedge^2\C^2$ in degree 0, and $\bigwedge^1\C^2=\C^2$ in degree 1.  Hence $\dim \bigwedge^*(\C^2)=0$.
\end{example}

\begin{definition}
The super McKay pairing is $Q_{SM}(V,W)=\dim (V\otimes W^\vee\otimes\bigwedge^*\C^2)^G$.
\end{definition}


\begin{theorem}[Equivariant Riemann-Roch]
$$\chi(\mathcal{F},\mathcal{G})=Q_{SM}([\mathcal{F}],[\mathcal{G}])$$
\end{theorem}


\subsection{Application to cores}

We now apply the Riemann-Roch theorem to the dimension and $K$-theory classes of cores.  Specifically, we will address the following question: given a class $v\in \overline{K}(G)$, what can we say about the dimension and $K$-theory class of the core Hilbert scheme in class $v$?

First, note that pairing with $[V_G]$ just counts the dimension, and since the super dimension of $\bigwedge^*\C^2$ is zero, it is in the kernel of the McKay pairing.  Geometrically, this corresponds to the fact that adding the structure sheaf of a smooth point on $[\C^2/G]$ will change the $K^0$ theory class by $V_G$, but the smooth point may be added disjoint from the support of the rest of the sheaf and the sheaf it is being paired with and hence not change any of the ext groups.


Thus, the Euler pairing $\chi$ descends to a pairing on $\overline{K}(G)=K^0(G)/V_G$.

Given a class $v\in \overline{K}(G)$, what is the minimum lift to $\tilde{v}\in K^0(G)$ with $[\tilde{v}]=v$ and $\Hilb_{\tilde{v}}$ nonempty?

As vector spaces, $\overline{K}(G)$ is isomorphic to the subset of $K^0(G)$ with entries summing to zero, but not quite as lattices.  Therefore for $G$ abelian we introduce the space 
$$S^0_G=\left\{v\in K^0(G; \Z[1/|G|])\Bigg | \sum_{\chi\in\irreps(G)}(\chi, v)=0\right\}$$
and we have an isomorphism $S^0_G$ and $\overline{K}(G)$.  


\begin{lemma}
Let $k$ be the index of $K_{[\C^2/G]}\in K(G)$.

Then
$$\tilde{v}=v+\frac{1}{2}\left(Q_M(v)+\dim\Hilb_{\tilde{v}} -v_0-v_{k}\right)[V_G]$$
\end{lemma}



\begin{proof}
We calculate $\chi(\tilde{v},\tilde{v})$ in two different ways, once from the definition, and once using the Riemann-Roch theorem.

Let $\OO_{\tilde{v}}$ be any quotient sheaf with the right $K$-theory class.  

We first use
$$\chi(\tilde{v}, \tilde{v})=\dim\Ext^0(\OO_{\tilde{v}},\OO_{\tilde{v}})-\dim\Ext^1(\OO_{\tilde{v}},\OO_{\tilde{v}})+\dim\Ext^2(\OO_{\tilde{v}},\OO_{\tilde{v}})$$

By definition $\Ext^0(\OO_{\tilde{v}},\OO_{\tilde{v}})=\Hom_R(R/\II,R/\II)^G$.  Now since $\OO_v$ generated as an $R$-module by $1\in R$, and so to define a homomorphism we just need to say where $1$ maps. Since $\II$ is an ideal, it can map to any element of $R/\II$.  Since 1 is fixed by $G$, to be $G$-equivariant we must preserve weight and map to something invariant.  So $\dim\Ext^0(\OO_{\tilde{v}},\OO_{\tilde{v}})=\tilde{v}_0$.  

Using Serre-duality, $\dim\Ext^2(\OO_{\tilde{v}},\OO_{\tilde{v}})=\dim\Ext^0(\OO_{\tilde{v}},K\otimes\OO_{\tilde{v}})$.  The effect of tensoring by $K$ is just to change the $G$ action -- an invariant vector of $\OO_{\tilde{v}}\otimes K$ is just a vector that transforms as $K^\vee$ in $\OO_{\tilde{v}}$.  
So $\dim\Ext^2(\OO_{\tilde{v}},\OO_{\tilde{v}})=\tilde{v}_{-k}$.  

Finally $\dim\Ext^1(\OO_{\tilde{v}},\OO_{\tilde{v}})=\dim\Hilb_{\tilde{v}}$.  So $\chi(\tilde{v},\tilde{v})=\tilde{v}_0+\tilde{v}_{-k}-\dim\Hilb_{\tilde{v}}$.  If we write $\tilde{v}=v+M [V_G]$, then $\tilde{v}_i=v_i+M$, and so  
\begin{equation} \label{eq:EXT-evaluation}
\chi(\tilde{v},\tilde{v})=v_o+v_{-k}+2M-\dim\Hilb_{\tilde{v}} 
\end{equation}

On the other hand, using Euler pairing using Riemann-Roch works exactly the same way, and we have
\begin{equation} \label{eq:RR-evaluation}
\chi(\tilde{v},\tilde{v})=Q_{SM}(v+M[V_G],v+M[V_G])=Q_M(v,v)
\end{equation}
using the fact that $[V_G]$ is in the kernel of $Q_{SM}$.  

Setting Equations \ref{eq:EXT-evaluation} and \ref{eq:RR-evaluation} equal and solving for $M$ gives the desired result.

\end{proof}


\begin{corollary}
The map $v\mapsto \dim\Hilb_{\tilde{v}}$ is a piecewise quadratic function.
\end{corollary}

\begin{proof}
Using cores, we have already seen that $\tilde{v}$ is a piecewise quadratic function of $v$.  
\end{proof}


\begin{corollary}  If $G\in SL_2$. Then
$$\tilde{v}=v-v_0+\frac{1}{2}Q_M(v,v)[V_G]$$
In particular, we see $\tilde{v}$ is a quadratic function of $v$.
\end{corollary}

\begin{proof}
When $G\in SL_2$, we the canonical bundle $K_{[\C^2/G]}$ is trivial, and so $k=0$.  Furthermore, when $G\in SL_2$, the core partitions are isolated points and hence have dimension 0.
\end{proof}


EXAMPLE SHOWING THIS GIVES THE SAME THING,.





\appendix

\section{Betti numbers of $\Hilb_n(\C^2)$}
This appendix reviews Ellingsrud-Str\o mme's computation of the poincare polynomial of $\Hilb_n(\C^2)$; it is aimed at combinatorialists.  

The main tool is the $(\C^*)^2$ action on $\Hilb_n(\C^2)$ induced by the $(\C^*)^2$ action on $\C^2$.  The torus $(\C^*)^2$ acts on the plane $\C^2$ in the obvious way: $(s,t)\cdot (\alpha,\beta)=(s\alpha,t\beta)$.  This induces an action on $R=\C[x,y]$ and on $\Hilb_n(\C^2)$.  

\begin{warning} \label{warning:action-sign}

 The elements of $R$ are functions on $\C^2$, and thus $(\C^*)^2$ acts with \emph{opposite} weights as might naively be expected, that is 
$$(s,t)\cdot x^ny^m=s^{-n}t^{-m}x^ny^m$$
\end{warning}




Many proofs of this are in the literature; for instance \cite{cheah} (IS IT IN THIS OR ONLY THE THESIS?) gives a largely combinatorial one, and \cite{nakajimabook}   Our proof is essentially the combinatorial one in \cite{cheah}, or , but made more so in that we use the boundary path of the partition instead of ``systems of arrows''.  






\subsection{Warm-up: Euler Characteristic of $\Hilb_n(\C^2)$} \label{sec:Teuler}

To illustrate how the torus action is used, we first compute the Euler characteristic of $\Hilb_n(\C^2)$.




\begin{proposition} \label{prop:hilbchi}
$$\chi(\Hilb_n(\C^2))=p(n).$$
Or, in terms of generating functions:
$$\chi(\Hilb_{\C^2})=\prod_{k\geq 0} \frac{1}{1-q^k}.$$
\end{proposition}

As a consistency check, this is what's obtained by setting $t=-1$ in Theorem \ref{thm:ES}.


Proposition \ref{prop:hilbchi} follows immediately from the following three lemmas.

\begin{lemma} \label{lem:toruschi}
Suppose that $X$ has a $T=(\C^*)^n$ action, with fixed point set $X^T$.  Then $\chi(X)=\chi(X^T)$.
\end{lemma}

\begin{lemma} \label{lem:Tmonomials}
The $T$-fixed points on $\Hilb_n(\C^2)$ are the monomial ideals.
\end{lemma}

\begin{lemma} \label{lem:monomialspartitions}
There is a bijection between monomial ideals $\II\subset R$ with $\dim_\C R/\II=n$ and partitions of $n$.
\end{lemma}

\begin{proof}[Sketch of Lemma \ref{lem:toruschi}]

  The pertinent fact about the Euler characteristic that makes it easy to compute is that it is additive over subvarieties: if $X\subset Y$ is a closed subvariety, then we have
  \[\chi(Y)=\chi(X)+\chi(Y\setminus X)\]
Note that this is not true of real submanifolds (take, e.g. $\{1\}\subset S^1$ as $X\subset Y$), and in some view is essentially because complex submanifolds have even codimension.


%Note that this is not true for real manifolds; take, the example of a point in $S^1$, both the point and its complement have euler characteristic 1, while $S^1$ has euler characteristic 0.  We briefly sketch the proof in case $X$ is a complex \emph{submanifold}.  If $U$ and $V$ are an open covering, then the Mayer-Vietoris sequence and the definition of $\chi$ give
%$$\chi(Y)=\chi(U)+\chi(V)-\chi(U\cap V)$$
%Taking $U=Y\setminus X$, and $V$ a tubular neighborhood of $X$, we see that $U\cap V$ we will be a homotopy equivalent to the normal sphere bundle of $X$ in $Y$.  Suppose that $X$ has complex codimension $k$; then $\chi(U\cap V)=\chi(X)\chi(S^{2k-1})=0$, since odd dimensional spheres have euler characteristic 0.

To apply this fact to the case when $T$ acts on $X$, we stratify $X$ according to its stabilizer subgroup.  For any subgroup $H\subset G$, we let $X^{(H)}\subset X$ denote the subset with stabilizer group $H$.  Then we have
\[\chi(X)=\sum_{H\subset G} \chi\left(X^{(H)}\right)\]
is a union of locally closed sets, to hence Lemma \ref{lem:toruschi} reduces to showing $\chi(X^{(H)})=0$ unless $H=G$.

The point now is that $X^{(H)}$ has a free action of $G/H$, and so is a $G/H$ bundle over the quotient $X^{(H)}/(G/H)$.  For any fiber bundle $Y$ with fiber $F$ and base space $B$ we have $\chi(Y)=\chi(B)\cdot \chi(F)$.  Since $G/H$ is itself a torus it has $\chi(G/H)=0$ unless $G=H$.  
\end{proof}


We now prove the $T$ fixed ideals are precisely the monomial ideas.
\begin{proof}[Proof of Lemma \ref{lem:Tmonomials}]
The torus $T$ acts on a monomial $x^\alpha y^\beta$ by scaling.  If $m\in \II$ is a monomial, and $g\in T$ then $g\cdot m=am\in \II$ for some $a\in \C$.  Hence an ideal generated by monomials will be $T$ fixed.  

In the other direction, suppose that $\II$ is $T$ fixed, and $f\in\II$.  We show all monomials in $f$ are in $\II$.  Suppose that $f$ is a linear combination of $k$ monomials $m_i$. Then there are $t_1,\cdots, t_k\in T$ so that $f_i=t_i \cdot f\in \II$ are linearly independent over $\C$. Inverting the matrix that expresses $f_i$ in terms of the monomials $m_i$, we see that $m_i$ is a linear combination of the $f_i$, and hence $m_i\in\II$.
\end{proof}



\begin{proof}[Proof of Lemma \ref{lem:monomialspartitions}]

The bijection between monomial ideals with $\dim R/\II=n$ and partitions of $n$ is best illustrated by example: 

\begin{center}
\begin{tikzpicture}
\draw[fill=red!20] (0,2) rectangle (1,3);
\draw[fill=red!20] (1,1) rectangle (2,2);
\draw[fill=red!20] (3,0) rectangle (4,1);


\draw[thin, gray] (0,0) grid (4.5,3.5);
\foreach \x in {0,...,4}
   \foreach \y in {0,...,3}
       \node at (\x+.5,\y+.5) {$x^\x y^\y$};
\draw[ultra thick, black] (0,0)--(0,2)--(1,2)--(1,1)--(3,1)--(3,0)--cycle;

\draw node at (7.5, 2) {$\begin{array}{cc} \II & \lambda \\ (x^3,xy,y^2) & (2,1,1) \end{array}$};
\end{tikzpicture}
\end{center}

The monomials \emph{not} in $\II$ form a basis for $R/\II$, and correspond to the cells of a partition $\II_\lambda$.  The generators of $\II_\lambda$ correspond to the monomials in the exterior corners of $\lambda$, the squares in red above.

\end{proof}

Thus, we have proven Ellingsrud-Str\o mme on the level of Euler characteristic.  To updgrade this poincare polynomial, we must use the Bia\l ynicki-Birula decomposition.



\subsection{Bia\l ynicki-Birula decomposition}

The Bia\l ynicki-Birula decomposition is essentially an algebraic version of Morse theory.

Morse theory describes the topology of a smooth manifold $X$ of dimension $n$ in terms of a generic smooth function $f:X\to\R$.  The critical points of such a function will be nondegenerate, that is, have non-degenerate Hessian matrix, and hence be locally of the form
\[f=a+x_1^2+x_2^2+\cdots +x_k^2-x_{k+1}^2-x_{k+2}^2-\cdots -x_n^2\]

The Morse flow is the downward gradient flow of $f$; the stable manifold $S_p$ of a critical point $p$ is the set of all points of $X$ that flow to $p$.  At each critical point $p$, the tangent space $T_pX$ splits into $T^+_pX$, the tangent directions flowing into $p$, and $T_p^-X$, the tangent directions flowing out of $p$.


The role of the Morse flow will be played by the flow $x\mapsto \varepsilon x$ as $\varepsilon\in\C^*$ tends toward zero.  We assume that the $\C^*$ action on $X$ is such that this limit point exists for all $x\in X$.  

Let $p$ be a fixed point of the $\C^*$ action.  Then $\C^*$ acts on $T_pX$, and so $T_pX$ is not just a vector space but a $\C^*$ representation.   and hence decomposes into a direct sum of irreducible representations.  Let $V_a$ denote the irreducible representation of $\C^*$ where $\varepsilon\in\C^*$ acts as $\varepsilon^a$.  


Let $T_p^+X$ (respectively $T_p^-X$) denote the subspace of $T_pX$ where the $\C^*$ action acts with a positive (respectively negative) exponent, and let $T_p^0(X)$ denote the subspace where $\C^*$ acts trivially.  Thus, if we consider the flow $X$ sending $\lambda$ toward 0, $T_p^+X$ are the directions that are flowing twoard $p$, and $T_p^-X$ are the directions flowing away from $p$.  

Note that if $p$ is an isolated fixed point, then $T_p^0(X)=0$.

$$T_pX=\bigoplus_{n\in\Z} V_n^{e_n}$$
then
$$T_p^+X=\bigoplus_{n>0} V_n^{e_n}$$

Let 
$$\mathcal{S}_p=\{x\in X|\lim_{\varepsilon\to 0} \varepsilon x=p\}$$
Then the Bia\l ynicki-Birula decomposition states that $X=\sqcup_{p}\mathcal{S}_p$; the point is that $\mathcal{S}_p$ is a subvariety isomorphic to $A_k$.


We saw in Section \ref{sec:Teuler} that if $X$ is a variety with a $\C^*$ action with $k$ isolated fixed points, then $\chi(X)=k$.  If we know the weights of the $\C^*$ action on the tangent spaces of the fixed points, the Bia\l ynicki-Birula decomposition leverages this extra information to give the Betti numbers of $X$, or further, the class of $X$ in the Grothendieck ring of varieties.

\subsection{Applying Bia\l ynicki-Birula to $\Hilb_n(\C^2)$}
To apply the Bia\l ynicki-Birula decomposition to $\Hilb_n(\C^2)$, we need to determine the torus weights on each tangent space $T_\lambda\Hilb_n(\C^2)$.

\begin{lemma}[Ellingsrud and Str\o mme \cite{ES}] \label{lem:torus-weights}
$$T_\lambda \Hilb_n(\C^2)=\sum_{\square\in\lambda} \left(x^{-\ell(\square)} y^{a(\square)+1}+x^{\ell(\square)+1}y^{-a(\square)}\right)$$
\end{lemma}

Before giving a proof, we show how Lemma \ref{lem:torus-weights} implies Ellingsrud and Str\o mme's result. 

\begin{proof}[Ellingsrud-Str\o mme]

  We have a described a $(\C^*)^2$ action on $\Hilb_n(\C^2)$.  To apply Bia\l ynicki-Birula, however, we need a $\C^*$ action with isolated fixed points.  The solution is to pass to a generic one dimensional subtorus -- we use the subtorus $\C^*$ that acts on $\C^2$ with weights $(\varepsilon,1)$, for $\varepsilon$ very small.

  The choice of subtorus weights should really be integer numbers, and by $(\varepsilon, 1)$ we really mean an action $(1, N)$ with $N>>n$. Since $a(\square)$ and $\ell(\square)$ are bounded by $n$, this means that we will always have $a(\square)<<N$, and so thinking about $\varepsilon$ as $1/N$, we have $a(\square)\varepsilon<<1$, and similarly with $\ell(\square)$.

In the flow $\lambda\to 0$ the positive directions are the stable directions.
  
Recall Warning \ref{warning:action-sign} that $\C^*$ will act with \emph{opposite} weights on $x$ and $y$, so that $$t\cdot x^\alpha y^\beta=t^{-\alpha\varepsilon-\beta}x^\alpha y^\beta.$$  

We now determine $\dim^+(\lambda)$ using this subtorus.  The term $x^{-\ell(\square)} y^{a(\square)+1}$ has weight $\varepsilon\ell(\square)-a(\square)-1$, which will never be positive, and hence will never contribute to $\dim^+(\lambda)$.

The term $x^{\ell(\square)+1}y^{-a(\square)}$ has weight $a(\square)-\varepsilon\ell(\square)-\varepsilon$, which will be positive if and only if $a(\square)>0$.  The squares with $a(\square)=0$ are exactly those at the top of eacg column of $\lambda$. Viewing the columns as the parts of $\lambda$, we see that the $i$th column contributes $\lambda_i-1$ to $\dim^+(\lambda)$.


\begin{center}
\begin{tikzpicture}[scale=.5]
\draw[fill=red!20] (0,0) rectangle (1,2);
\draw[fill=red!20] (0,0) rectangle (3,1);


\draw[thin, gray] (0,0) grid (1,3);
\draw[thin, gray] (1,0) grid (3,2);

\draw[thick] (0,0)--(0,3)--(1,3)--(1,2)--(3,2)--(3,1)--(4,1)--(4,0)--cycle;

\draw (2,-1) node {$\dim^+(\lambda)$ is number of shaded squares};
\end{tikzpicture}
\end{center}

\end{proof}

\begin{remark}
  While we picked the subtorus $(\varepsilon, 1)$, any generic $\C^*$ action (say, $(s,1)$, with $s\in\R\setminus\Q$) will have isolated fixed points, and hence can be used to compute the cohomology of $\Hilb_n(\C^2)$.  Using a different $\C^*$ action will give a different dimension statistic $\dim_s^-(\lambda)$:

\[ \dim_s^-(\lambda)=\left|\left\{\square\in\lambda : \frac{a(\square)}{\ell(\square)+1}<s<\frac{a(\square)+1}{\ell(\square)}\right\}\right| \]

However, since each of these statistics compute $P_t(\Hilb_n(\C^2)$, we see that
\begin{equation} \label{eq:lw} \sum_{\lambda\in\PP} q^{|\lambda|}t^{\dim_s^-(\lambda)}=\prod_{m=1}^\infty \frac{1}{1-tq^m}
  \end{equation}

This was apparently first observed by Haiman, and in \cite{LW} Loehr and Warrington gave a combinatorial proof of Equation \ref{eq:lw}, and furthermore extending the statistic to the non-isolated case -- that is, to rational $s$.  It may be interesting to have a geometric understanding of the bijections in \cite{LW}.
\end{remark}


\subsection{Determination of the tangent weights}

It remains to prove Lemma \ref{lem:torus-weights}, which will also be the main tool needed in the body of the text.  There are many proofs; the one we present is as bijective as possible, and as far as we know does not appear in the literature, although an expert told us: ``Everyone who studies this subject discovers this proof; nobody's written it down because it's awkward to draw the pictures''.


We begin with the following the description of the the tangent space to the Hilbert scheme:
\begin{lemma} \label{lem:tangent-hom}
$$T_{\II}\Hilb_n(\C^2)=\Hom_R(\II,R/\II)$$
\end{lemma}
Lemma \ref{lem:tangent-hom} actually holds in any dimension, for any smooth variety.

Before giving a proof, for intuition we give a plausibility argument in analogy with the Grassmannian.  If $V\subset W$ is a $k$ dimensional subspace, then the tangent space is the way to deform $V$ slightly inside of $W$, which we see is
\[T_V Gr_k(W)\cong \Hom(V, V^\perp) \cong \Hom(V, W/V).\]
Thus, we see that  \emph{$\C$-linear maps} from $\II$ to $R/II$ give deformations of $\II$ as a \emph{vector subspace} of $R$.  It is reasonable to guess that if we want the deformation to remain an ideal, we should require it to be $R$-linear instead of just $\C$-linear.

\begin{proof}
More formally, it is a general fact that first order deformations of objects are given by $\Ext^1(\mathcal{F},\mathcal{F})$, and obstructions to these deformations are given by $\Ext^2(\mathcal{F},\mathcal{F})$. 

The long exact sequence of $R$-modules obtained by applying $\Hom_R(\II, -)$ to the short exact sequence
$$0\to \II\to R\to R/\II\to 0$$
gives 
$$0\to\Hom_R(\II,\II)\to \Hom_R(\II, R)\to\Hom_R(\II,R/\II)\to\Ext_R^1(\II, \II)\to\Ext_R^1(\II,R)$$
Since $\II$ is an ideal that eventually contains $x^n, y^m$, one can check that  $\Hom_R(\II,\II)\cong\Hom_R(\II, R)$;  and $\Ext^1(\II,R)=0$, and so indeed we have $\Hom_R(\II,R/\II)\cong\Ext_R^1(\II, \II)$.
\end{proof}


SYSTEMS OF ARROWS

We can now complete the proof of the tangent weight statement.

As the isomorphism was, it will respect the $(C^*)^2$ action.  Let $T_\lambda^{a,b}$ denote the $(a,b)$-isotypical component of $T_{\II_\lambda}\Hilb_n(\C^2)$.  Then vectors $v\in T_\lambda^{a,b}$ correspond to module homomorphisms $f\in\Hom_R(\II_\lambda, R/\II_\lambda)$ of weight $(a,b)$, i.e., with
$$f(x^{\alpha}y^\beta)=c_{\alpha,\beta} x^{\alpha-a}y^{\beta-b}$$
for some constant $c_{\alpha, \beta}$ (that can be different for different monomials).  


Let $P_\lambda$ be the boundary path of $\lambda$; for $(a,b)$ in $\Z^2$, let $P_\lambda(a,b)$ denote the boundary path of $\lambda$ shifted to the right by $a$ and up by $b$.

\begin{lemma} Let $B_\lambda(a,b)$ be the set of bounded regions above $P_\lambda$ and below $P_\lambda(a,b)$.  For $U\in B_\lambda(a,b)$, let $f_U$ denote the map that multiplies monomials in $U$ by $x^{-a}y^{-b}$ and sends monomials not in $B_\lambda(a,b)$ to $0$.  Then the $f_U$ form a basis for $T_\lambda^{a,b}$.
\end{lemma}

\begin{proof}
To be a map of $R$-modules the map must commute with multipication by $x$ and $y$.  Thus, if $x^{\alpha-a+1}y^{\beta-b}\notin \II$, we must have $c_{\alpha+1,\beta}=c_{\alpha,\beta}$, and similarly with $y$.  Thus, to be a map of $R$-modules, we see that monomials in the same component must get multiplied by the same constant.

If a region is not bounded, then one of the generators of $\II$ contained in that region would be mapped to a monomial with negative exponents, which it can't do; therefore it must be multiplied by 0.
\begin{center}
\begin{tikzpicture}[scale=.5]

\fill[red!20!white] (0,5)--(0,3)--(1,3)--(1,5)--cycle;
\fill[red!20!white] (1,3)--(2,3)--(2,2)--(1,2)--cycle;
\fill[red!20!white] (3,2)--(4,2)--(4,1)--(3,1)--cycle;
\fill[red!20!white] (4,1)--(5,1)--(5,0)--(4,0)--cycle;
\draw[thin, gray] (0,0) grid (5,5);
\draw (.5,3.5) node{$y^3$};
\draw (1.5,2.5) node{$xy^2$};
\draw (3.5,1.5) node{$x^3y$};
\draw (4.5,.5) node{$x^4$};

\begin{scope}[xshift=-.1cm, yshift=-.1cm]
\draw[thick, red,  triangle 60 reversed-triangle 60] (0,5)--(0,3)--(1,3)--(1,2)--(3,2)--(3,1)--(4,1)--(4,0)--(5,0);
\end{scope}
\begin{scope}[xshift=1.1cm, yshift=.1cm]
\draw[thick, blue, dashed, triangle 60 reversed-triangle 60]  (0,5)--(0,3)--(1,3)--(1,2)--(3,2)--(3,1)--(4,1)--(4,0)--(5,0);
\end{scope}

\begin{scope}[xshift=8cm]
\fill[red!20!white] (0,5)--(2,5)--(2,3)--(3,3)--(3,2)--(1,2)--(1,3)--(0,3)--cycle;
\fill[red!20!white] (3,2)--(5,2)--(5,1)--(6,1)--(6,0)--(4,0)--(4,1)--(3,1)--cycle;

\draw[thin, gray] (0,0) grid (5,5);
\draw (.5,3.5) node{$y^3$};
\draw (1.5,2.5) node{$xy^2$};
\draw (3.5,1.5) node{$x^3y$};
\draw (4.5,.5) node{$x^4$};
\begin{scope}[xshift=-.1cm, yshift=-.1cm]
\draw[thick, red,  triangle 60 reversed-triangle 60] (0,5)--(0,3)--(1,3)--(1,2)--(3,2)--(3,1)--(4,1)--(4,0)--(5,0);
\end{scope}
\begin{scope}[xshift=2.1cm, yshift=.1cm]
\draw[thick, blue, dashed, triangle 60 reversed-triangle 60]  (0,5)--(0,3)--(1,3)--(1,2)--(3,2)--(3,1)--(4,1)--(4,0)--(5,0);
\end{scope}
\end{scope}



\end{tikzpicture}
\end{center}
The picture on the left shows $(1,0)$ is three dimensional.  The region containing $y^3$ is unbounded; indeed, $y^3$ would have to map to $x^{-1}y^3\notin R/\II$.  

The picture on the right shows $(2,0)$ is one dimensional; $y^3$ ad $xy^2$ would each map to things not in $R/\II$ because they are in an unbounded region.  We also have that $x^3y$ and $x^4$ must get multiplied by the same constant, since $xf(x^3y)=x^2y=yf(x^4)$ and $x^2y\in R\II$.
\end{proof}


We now prove Lemma \ref{lem:torus-weights}.  First, observe that $T_\lambda^{(a,b)}$ is empty if $(a,b)$ are both negative or both non-negative.  If both are non-negative, then there are no cells at all below $P_\lambda(a,b)$ and above $P_\lambda$.  If both are positive, then the cells below $P_\lambda(a,b)$ and $P_\lambda$ form a single unbounded region.  
\begin{center}
\begin{tikzpicture}[scale=.5]
\fill[blue!20!white] (0,5)--(1,5)--(1,4)--(2,4)--(2,3)--(4,3)--(4,2)--(5,2)--(5,0)--(4,0)--(4,1)--(3,1)--(3,2)--(1,2)--(1,3)--(0,3)--cycle;
\draw (.5,3.5) node{$y^3$};
\draw (1.5,2.5) node{$xy^2$};
\draw (3.5,1.5) node{$x^3y$};
\draw (4.5,.5) node{$x^4$};
\draw[thin, gray] (0,0) grid (5,5);
\begin{scope}[xshift=-.1cm, yshift=-.1cm]
\draw[thick, red,  triangle 60 reversed-triangle 60] (0,5)--(0,3)--(1,3)--(1,2)--(3,2)--(3,1)--(4,1)--(4,0)--(5,0);
\end{scope}
\begin{scope}[xshift=1.1cm, yshift=1.1cm]
\draw[thick, blue, dashed, triangle 60 reversed-triangle 60]  (0,5)--(0,3)--(1,3)--(1,2)--(3,2)--(3,1)--(4,1)--(4,0)--(5,0);
\end{scope}

\begin{scope}[xshift=9cm]
\draw[thin, gray] (0,0) grid (5,5);
\draw (.5,3.5) node{$y^3$};
\draw (1.5,2.5) node{$xy^2$};
\draw (3.5,1.5) node{$x^3y$};
\draw (4.5,.5) node{$x^4$};
\begin{scope}[xshift=-.1cm, yshift=-.1cm]
\draw[thick, red,  triangle 60 reversed-triangle 60] (0,5)--(0,3)--(1,3)--(1,2)--(3,2)--(3,1)--(4,1)--(4,0)--(5,0);
\end{scope}
\begin{scope}[xshift=-.9cm, yshift=.1cm]
\draw[thick, blue, dashed, triangle 60 reversed-triangle 60]  (0,5)--(0,3)--(1,3)--(1,2)--(3,2)--(3,1)--(4,1)--(4,0)--(5,0);
\end{scope}
\end{scope}

\end{tikzpicture}
\end{center}
The left shows that for $(1,1)$ are both positive, then there is a single unbounded region.  The right shows that for $(-1,0)$ there are no cells above $P_\lambda$ and below $P_\lambda(-1,0)$.
Thus, exactly one of $a,b$ is negative; assume it is $a$.  We must show that the elements of $B_\lambda(a,b)$ are in bijection with the cells $\square\in\lambda$ having  $a=\ell(\square)$ and $b=-a(\square)-1$ (recall the sign from Warning \ref{warning:action-sign}).

Consider a region of cells above $P_\lambda$ and below $P_\lambda(-a,-b)$.  There are two possible directions this region could be unbounded -- along the positive $y$ or $x$-axes.  Since $b$ is positive, there are no squares far along the $x$-axis both below $P_\lambda(-a,-b)$  and above $P_\lambda$, and so the region is automatically bounded in that direction.  

We must therefore guarantee the region is bounded at the bottom right.  This will happen when a South step of $P_\lambda$ starts at the same point as East step of $P_\lambda(-a,-b)$.  




Bounded cells well thus be in bijection with pairs of such cells.  Translating the East step back $(a,b)$ to its original place on the boundary strip, we find these two steps give an inversion in the $P_\lambda$ and hence a cell of $\lambda$.  The arm length of this cell will be $b+1$, and the leg will have size $a$. 

An analogous argument shows that tangent directions with $b$ negative correspond to the other terms in the sum.

\section{Geometry of resolutions and the McKay correspondence}


Theorem \ref{thm:GHilb-resolution} is useful because it gives a modular interpretation of the minimal resolution.  It also shows the geometry of the minimal resolution appearing.

The resolution of the $\C^2/G$ singularity is rational; hence the exceptional locus is a tree of $\proj^1$'s joining together.  In case $G$ is cyclic, the resolution is actually a chain of rational curves with negative self intersection.  See Chapter 10 of \cite{toric} for a thorough discussion of this.

\begin{center}
\begin{tikzpicture}[xscale=.75]
\draw plot [smooth, tension=1] coordinates {(0,0) (2,.5) (4,0)};
\draw plot [smooth, tension=1] coordinates {(3,0) (5,.5) (7,0)};
\draw plot [smooth, tension=1] coordinates {(6,0) (8,.5) (10,0)};
\draw plot [smooth, tension=1] coordinates {(9,0) (11,.5) (13,0)};

\draw (2,1) node{$-2$};
\draw (5,1) node{$-4$};
\draw (8,1) node{$-3$};
\draw (11,1) node{$-3$};

\end{tikzpicture}
\end{center}

$$
\begin{bmatrix}
-2 & 1 & 0 & 0 \\
1 & -4 & 1 & 0 \\
0 & 1 & -3 & 1 \\
0 & 0 & 1 & -3 
\end{bmatrix}
$$

The number and self-intersection of the components of the exception divisor are given by the \emph{Hirzebruch-Jung} continued fraction expansion of $r/a$.  That is, if we write
$$
\frac{r}{a}=b_1-\cfrac{1}{b_2-\cfrac{1}{b_3-\cfrac{1}{\cdots - \cfrac{1}{b_r}}}}
$$  
then the exception divisor as $r$ components in a chain, and the $i$th component has self-intersection $-b_i$. 

\begin{example}[Diagonal action]
Consider the diagonal action of $\Z_r$ on $\C^2$; this corresponds to $a=1$, and so the Hirzebruch-Jung continued fraction is simply $r/1=r$.  The exceptional divisor consists of one component with self intersection $-r$.

\end{example}


\begin{example}[The anti-diagonal case]  
In this case, the Hirzebruch-Jung continued fraction is
$$r/(r-1)=\underbrace{2-\cfrac{1}{2-\cfrac{1}{\cdots-\cfrac{1}{2}}}}_{\text{$r-1$ times}}$$
Thus, the resolution consists of a chain $r-1$ -2 curves.
\end{example}

\begin{example}[The other $\Z_5$ case]
As a final example, consder $\Z_5$ acting with weights $(1,2)$.  Switching the role of $x$ and $y$, this is equivalent to $\Z_5$ acting with weights $(1,3)$.

We have the continued fraction expansions
$$5/2=3-\cfrac{1}{2}$$
$$5/3=2-\cfrac{1}{3}$$
The minimal resolution thus consists of a -3 curve meeting a -2 curve; the choice of which direction we choose as $x$ and $y$ corresponds to which edge of the chain we start at.
\end{example}

The intersection pairing of the minimal resolution $\widetilde{S}_{a/r}$ will play an important role later.  The components of the exception curve form a basis for 


\subsection{McKay Correspondence}
The McKay correspondence is relates the geometry of $\widetilde{S}_G$ to the representation theory of $G$.

\begin{definition}
Let $G$ be a finite group, and $W$ a representation of $G$.  The \emph{McKay graph} $\Gamma_V$ is the directed graph with vertex set $\irreps(G)$, and if $U$ and $V$ are two irreps of $G$, the multiplicity of the edges from $U$ to $V$ is the multiplicity of $V$ in $U\otimes W$.
\end{definition}

The subgroups of $SU_2$ have an ADE classification.  There are two infinite series: cyclic groups, binary dihedral groups, and double covers of the isometries of the symmetries of the platonic solids.

McKay observed \cite{McKay} that when $G\subset SL_2(\C)$, the McKay graph of the defining two dimension representation was the \emph{affine} version of the corresponding ADE Dynkin diagram.  Removing the vertex corresponding to the trivial representation gives the usual ADE Dynkin diagram.  Furthermore, the exceptional locus of the minimal resolution $\widetilde{S}_G$ of the corresponding singularity has all $-2$ curves, with dual graph the corresponding Dynkin diagram. 






A geometric explanation of this was first given by Gonzalez-Sprinberg and Verdier \cite{GSV}, by constructing vectors bundles $E_\rho$ on the minimal resolution $\widetilde{S}_G$, labeled by the irreducible representations $\rho$ of $G$, so that $c_1(E_\rho)$ was the corresponding component of the exception divisor.

Ito and Nakamura observed the $G\Hilb$ is the minimal resolution \cite{IN}.

The description of the minimal resolution $\widetilde{S}_G$ as $G-\Hilb$ gives a natural construction of these vector bundles: for each irrep $\rho$ of $G$, we have on the one hand a tautological bundle $\mathbb{E}_\rho$ over $G-\Hilb$, and on the other hand a vertex of the McKay graph.  

$$c_1(\mathbb{E}_\rho)=E_\rho$$

Furthermore, viewing the minimal resolution as a moduli space of objects on the orbifold gives rise to powerful tools using the derived category.  

In dimensions higher than two, Hilbert schemes of points on a smooth surface are not smooth, and we no longer have any reason to expect that $G-\Hilb$ would be smooth, or a crepant resolution of $\C^n/G$ -- indeed, in dimensions 4 or higher, gorenstein quotient singularities need not have crepant resolutions.

It turns out that in many cases of interest, $G-\Hilb$ is smooth in this case, and a crepant resolution of $\C^2/G$.  This was proven by Bridgeland, King and Reid in \cite{BKR} for dimension three, and Haiman's work on $\Hilb_n(\C^2)$ is essentially showing that it is $S_n-\Hilb(\C^n)$.



\subsection{The special McKay correspondence}

When $G$ is not in $SL_2$, the number of components in the exception divisor of $\widetilde{S}_G$ is strictly less than the number of nontrivial irreducible representations of $G$.  The \emph{special McKay correspondence} started by Wunram \cite{wunram} picks out a subset of the irreps of $G$, called the \emph{special} representations, and gives a labeling of the irreducible components of the exception divisor of $G$ by the special representations, so that we still have $c_1(\mathbb{E}_\rho)=E_\rho$.

Kidoh \cite{Kidoh} in the cyclic case and Ishii \cite{ishii} in the general case proved that we still have $G\Hilb$ is the minimal resolution.

Ito \cite{ito} gave the following combinatorial description of the special representations.  

\begin{theorem}[\cite{ito}, Theorem 3.7]
Defines $B(G)$ to be the set of monomials which are not divisible by any $G$-invariant monomial, and defines $L(G)$ to be the set of monomials not divisible by $xy, x^{|G|}, y^{|G|}$.  Then a representation $\rho$ is special if and only if the corresponding monomial is not contained in $B(G)\setminus L(G)$.
\end{theorem}


Although we will work mainly at the level of homology, it is worth noting the McKay and special McKay correspondences hold at the level of derived categories.  (KAPRANOV-VASSEROT, ISHII)




\bibliographystyle{plain}
\bibliography{GHilb}

\end{document}
