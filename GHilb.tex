\documentclass{amsart}[12pt]
%\pdfoutput=1

\usepackage{tikz}
\usetikzlibrary{arrows} %for arrowtips 
\usepackage[sc]{mathpazo}
\usepackage{hyperref}
\usepackage{microtype}
\usepackage{tikz}
\usepackage{graphicx}
\usepackage{mathtools} %for \mathclap, fixing long subscripts in a summation
\linespread{1.2}
\usepackage{xcolor}
\hypersetup{
    colorlinks,
    linkcolor={red!80!black},
    citecolor={blue!80!black},
    urlcolor={blue!80!black}
}


\theoremstyle{definition}

\newtheorem*{theorem*}{Theorem}
\newtheorem{dummy}{}[section]
\newtheorem{theorem}[dummy]{Theorem}
\newtheorem{lemma}[dummy]{Lemma}
\newtheorem{example}[dummy]{Example}
\newtheorem{corollary}[dummy]{Corollary}
\newtheorem{definition}[dummy]{Definition}
\newtheorem{remark}[dummy]{Remark}
\newtheorem{proposition}[dummy]{Proposition}
\newtheorem{observation}{Observation}
\newtheorem{question}{Question}
\newtheorem{conjecture}[dummy]{Conjecture}
\newtheorem{warning}[dummy]{Warning}

\newcommand{\Z}{\mathbb{Z}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\proj}{\mathbb{P}}
\newcommand{\core}{\mathbf{core}}

\DeclareMathOperator{\Hilb}{Hilb}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\DC}{DH}
\DeclareMathOperator{\Sym}{Sym}


\begin{document}
\title{Orbifold Hilbert schemes and a generalization of cores and quotients}


\author{Paul Johnson}
\address{University of Sheffield}
\email{paul.johnson@sheffield.ac.uk}


\maketitle

\section{Introduction}
\cite{GLMpower}

\section{Hilbert schemes of points on surfaces}

Throughout, $R=\C[x,y]$ will be the polynomial ring in two variables.  

The Hilbert scheme of points in the plane parameterizes ideals $\mathcal{I}$ of $R$ of codimension $n$.
$$\Hilb_n(\C^2)=\{\mathcal{I}\subset R | \dim_\C R/\mathcal{I}=n\}$$
The space $\Hilb_n(\C^2)$ is smooth and connected of dimension $2n$.

Geometrically, $\Hilb_n(\C^2)$ should be thought of as follows.  Let $\Sym^n(\C^2)=(\C^2)^n/S_n$ be the set of $n$ onordered points in $\C^2$.  $\Sym^n(\C^2)$ is singular for $n>1$, with singularities occuring where the points are not unique.  
If $P=\{p_1,p_2,\dots, p_n\}$ is a set of $n$ distinct points in the plane, thenon the one hand the ideal $\mathcal{I}_{P}=\{f\in R| f(p)=0 \text{ for }p\in \mathbf{p}\}$ of functions vanishing on $P$ is in $\Hilb_n$.  If two of the points collide, there is still a limiting ideal $\mathcal{I}$ consisting of.  The resulting ideal is not reduced, and the non-reduced structure ``remembers'' some of how they collide.

\begin{example}
Let $(a,b)\neq (0,0)\in\C^2$, and let $P_t$ be the pair of distinct points $(0,0)$ and $(at,bt)$.  What is the limit of $\mathcal{I}_{P_t}$ as $t\to 0$?


The ideal $\mathcal{I}_{P_t}$ of functions vanishing on these points is 
$$(\{x,y\})(\{x-at,y-bt\})=(\{x(x-at),x(y-bt), y(x-at), y(y-bt)\}$$
Setting $t=0$, we see that the limiting ideal should contain $x^2, xy$ and $y^2$.  If it were just the ideal generated by these three monomials, it would have codimension 3, not two, so it must contain something else.

Taking the difference of the the middle two generators, we see that $\mathcal{I}_{P_t}$ contains the element $btx-aty$, and since it is an ideal and $t$ is a nonzero scalar, it must contain $bx-ay$.  Since this element is independent of $t$, we see that it certain should be contained in the limit as well; including this along with all monomials of degree two or higher gives an ideal of codimension 2 as desired.
y
Another way of writing the ideal $\mathcal{I}_{P_0}$ is as 
$$\mathcal{I}_{P_0}=\{f\in R| f(0)=\partial_vf(0)=0\}$$
where here $v=(a,b)$ is the direction the two points collided in.  Thus, the non-reduced scheme structure at $\mathcal{I}_{P_0}$ \emph{remembers} the direction the point collided from.
\end{example}

The torus $(\C^*)^2$ acts on the plane $\C^2$ in the obvious way, $(s,t)\cdot (\alpha,\beta)=(s\alpha,t\beta)$ and hence on $R=\C[x,y]$ and $\Hilb_n(\C^2)$.  

\begin{warning} \label{warning:action-sign}

 The elements of $R$ are functions on $\C^2$, and thus $(\C^*)^2$ acts with \emph{opposite} weights as might naively be expected, that is 
$$(s,t)\cdot x^ny^m=s^{-n}t^{-m}x^ny^m$$

\end{warning}




\subsection{Colored square counting}

The core construction helps us with the colored box square counting:

Consider the function
$$P_G(q_0,\dots,q_{r-1})=\sum_{\lambda\in\mathcal{P}} \mathbf{q}^{|\lambda|^G}$$
where 
$$\mathbf{q}^{|\lambda|_G}=\prod_{i=0}^{r-1} q_i^{|\lambda|^G_i}$$
that counts partitions according to their full colored square count as opposed to just their size; alternatively, the coefficient of $\mathbf{q}^v$ is the euler characteristic of $\Hilb_v([\C^2/G])$.

What can we say about $P_G$?  First, we consider the case where $G\subset SL_2$.  Let $Q=q_0q_1\cdots q_{r-1}$.  The core construction gives
$$P_G=\prod_{i=1}^\infty\frac{1}{(1-Q^i)^r} \sum_{w} Q^{A(w)}\mathbf{q}^w $$
Thus, we see in this case $P_G$ is a multivariable theta function.

In case $r=2$, this has an infinite product expansion using the Jacobi identity.  In fact, work of Boulet shows that actually the case $G=\Z_2\times \Z_2$ has an infinite product expansion.  Letting $q_{00}, q_{01}, q_{10}, q_{11}$ denote the variables, we have

$$P_{\Z_2\times\Z_2}=\prod_{i=1}^\infty \frac{(1+q_{00}^jq_{01}^{j-1}q_{10}^{j-1}q_{11}^{j-1})(1+q_{00}^jq_{01}^jq_{10}^jq_{11}^{j-1})}{(1-q_{00}^jq_{01}^jq_{10}^jq_{11}^j)(1-q_{00}^jq_{01}^jq_{10}^{j-1}q_{11}^{j-1})(1-q_{00}^jq_{01}^{j-1}q_{10}^{j}q_{11}^{j-1})}$$

However, even the one variable specialization $P_{\Z_3}(q,1,1)$ does not have a nice infinite product expression, as observed by Bal\'azs Szendr\"oi \cite{Bmo}; as it has a root at $-e^{\pi/\sqrt{3}}$ \cite{Borwein2}.


\subsection{Hilbert schemes of points in the plane}


\begin{theorem}[Ellingsrud and Str\o mme, 1987]
$$\sum_{k,n \geq 0} b_k(\Hilb_n(\C^2))t^k q^n=\prod_{\ell=1}^\infty \frac{1}{1-t^{2\ell-2}q^\ell}$$
\end{theorem}



\subsubsection{Bia\l ynicki-Birula decomposition}
Proved using the Bia\l ynicki-Birula decomposition.  The Bia\l ynicki-Birula decomosition should be understood in analogy with Morse theory.  

The role of the Morse flow will be played by the flow $x\mapsto \varepsilon x$ as $\varepsilon\in\C^*$ tends toward zero.  We assume that the $\C^*$ action on $X$ is such that this limit point exists for all $x\in X$.  

Let $p$ be a fixed point of the $\C^*$ action.  Then linearizing the $\C^*$ action on $X$ gives a $\C^*$ action on $T_pX$, and so $T_pX$ is not just a vector space but a $\C^*$ representation, and hence decomposes into a direct sum of irreducible representations.  Let $V_a$ denote the irreducible representation of $\C^*$ where $\varepsilon\in\C^*$ acts as $\varepsilon^a$.  

Let $T_p^+X$ (respectively $T_p^-X$) denote the subspace of $T_pX$ where the $\C^*$ action acts with a positive (respectively negative) exponent.  I.e., if

$$T_pX=\bigoplus_{n\in\Z} V_n^{e_n}$$
then

Let 
$$\mathcal{S}_p=\{x\in X|\lim_{\varepsilon\to 0} \varepsilon x=p\}$$
Then clearly we have $X=\sqcup_{p}\mathcal{S}_p$; the point is that $\mathcal{S}_p$ is a subvariety isomorphic to $\C^{\iota(p)}$.



We first observe that $V_0$ cannot occur in $T_pX$, as 

We saw in Section [REFER BACK TO ] that if $X$ is a variety with a $\C^*$ action with $k$ isolated fixed points, then $\chi(X)=k$.  If we know the weights of the $\C^*$ action on the tangent spaces of the fixed points, the Bia\l ynicki-Birula decomposition leverages this result to give the betti numbers of $X$, or even further the class of $X$ in the Grothendieck ring of varieties.

\subsubsection{Tangent space to a monomial ideal}
To apply the Bia\l ynicki-Birula decomposition to $\Hilb_n(\C^2)$, we need to calculate the weights of the $\C^*$ action on $T_\lambda\Hilb_n(\C^2)$.

\begin{lemma}[Ellingsrud and Str\o mme \cite{ES}] \label{lem:torus-weights}
$$T_\lambda \Hilb_n(\C^2)=\sum_{\square\in\lambda} \left(x^{-\ell(\square)} y^{a(\square)+1}+x^{\ell(\square)+1}y^{-a(\square)}\right)$$
\end{lemma}

\begin{proof}



First, we use $T_\lambda\Hilb_n(\C^2)=\Hom_R(\mathcal{I}_\lambda,R/\mathcal{I}_\lambda)$.

Analogy with the Grassmannian makes this intuitively plausible; indeed, if $V\subset W$ is a $k$ dimensional subspace, then $T_V Gr_k(W)=\Hom(V, V^\perp)=\Hom(V, W/V)$.  Thus, we understand the deformations of $\mathcal{I}_\lambda$ as a vector space; for the deformation to remain an ideal it is plausible that we should require the deformation to be a map of $R$ modules and not just vector spaces.

More formally, it is a general fact that first order deformations of objects are given by $\Ext^1(\mathcal{F},\mathcal{F})$, and obstructions to these deformations are given by $\Ext^2(\mathcal{F},\mathcal{F})$; starting from this fact and considering the long exact sequences by taking $\Hom(\mathcal{I})$ to

$$0\to \mathcal{I}\to R\to R/\mathcal{I}\to 0$$
gives the result.

\end{proof}


Let $T_\lambda^{a,b}$ denote the $(a,b)$-isotypical component of $T_{\mathcal{I}_\lambda}\Hilb_n(\C^2)$.  Viewed as an element of $\Hom(\mathcal{I}_\lambda, R/\mathcal{I}_\lambda)$, any such map multiplies some subset of the monomials in $\mathcal{I}_\lambda$ by $cx^a y^b$, for some constant $c$, and sends the other monomials in $\mathcal{I}_\lambda$.  

Let $P_\lambda$ be the boundary path of $\lambda$; for $(a,b)$ in $\Z^2$, let $P_\lambda(a,b)$ denote the boundary path of $\lambda$ shifted to the right by $a$ and up by $b$.

\begin{lemma} Let $B_\lambda(a,b)$ be the set of bounded regions above $P_\lambda$ and below $P_\lambda(-a,-b)$.  For $b\in B_\lambda(a,b)$, let $f_b$ denote the map that multiplies monomials in $b$ by $x^ay^b$ and sends monomials not in $B_\lambda(a,b)$ to $0$.  Then the $f_b$ form a basis for $T_\lambda^{a,b}$.
\end{lemma}

\begin{proof}


\end{proof}


We now prove Lemma \ref{lem:torus-weights}.  First, observe that $T_\lambda^{(a,b)}$ is empty if $(a,b)$ are both negative or both non-negative.  If both are non-negative, then there are no cells at all below $P_\lambda(-a,-b)$ and $P_\lambda$.  If both are positive, then the cells below $P_\lambda(-a,-b)$ and $P_\lambda$ form one unbounded region.  

\begin{tikzpicture}[scale=.5]
\fill[, rectangle] ( 
\draw[thin] (0,0) grid (5,10);
\begin{scope}[xshift=-.1cm, yshift=-.1cm]
\draw[thick, red,  triangle 60 reversed-triangle 60] (0,10)--(0,7)--(1,7)--(1,4)--(2,4)--(2,1)--(4,1)--(4,0)--(5,0);
\end{scope}
\begin{scope}[xshift=.1cm, yshift=2.1cm]
\draw[thick, blue,  triangle 60 reversed-triangle 60] (0,10)--(0,7)--(1,7)--(1,4)--(2,4)--(2,1)--(4,1)--(4,0)--(5,0);
\end{scope}



\end{tikzpicture}


Thus, exactly one of $a,b$ is negative; assume it is $a$.  We must show that the elements of $B_\lambda(a,b)$ are in bijection with the cells $\square\in\lambda$ having  $a=\ell(\square)$ and $b=-a(\square)-1$ (recall the sign from Warning \ref{warning:action-sign}.

Consider a region of cells above $P_\lambda$ and below $P_\lambda(-a,-b)$.  There are two possible directions this region could be unbounded -- along the positive $y$ or $x$-axes.  Since $b$ is positive, there are no squares far along the $x$-axis both below $P_\lambda(-a,-b)$  and above $P_\lambda$, and so the region is automatically bounded in that direction.  

We must therefore guarantee the region is bounded at the bottom right.  This will happen when a South step of $P_\lambda$ starts at the same point as East step of $P_\lambda(-a,-b)$.  

Bounded cells well thus be in bijection with pairs of such cells.  Translating the East step back $(a,b)$ to its original place on the boundary strip, we find these two steps give an inversion in the $P_\lambda$ and hence a cell of $\lambda$.  The arm length of this cell will be $b+1$, and the leg will have size $a$. 

A similar argument shows that tangent directions with $b$ negative correspond to. 



The topology of Hilbert schemes of points on surfaces was found by G\o ttsche.  A key point is that rather than study $\Hilb_n(S)$ for fixed $n$, it is easier to study them for all $n$ at once.


\begin{theorem}[G\"ottsche, \cite{gottsche}]
Let $S$ be a smooth quasiprojective surface, and when $b_i$ appears in isolation, let it be $b_i(S)$.  Then:
$$\sum_{k,n} b_k(S^{[n]})t^k q^n=\prod_{\ell\geq 1} \frac{(1+t^{2\ell-1}q^\ell)^{b_1}(1+t^{2\ell+1}q^\ell)^{b_3}}{(1-t^{2\ell-2}q^\ell)^{b_0}(1-t^{2\ell}q^\ell)^{b_2}(1-t^{2\ell+2}q^\ell)^{b_4}}$$
\end{theorem}

G\"ottsche's original proof used the Weil conjectures to reduce to the local model of the smooth surfaces, $S=\C^2$, where his formula is exactly Ellingsrud and Str\o mme's result.

Later proofs used power structures on the Grothendieck ring of varieties to  ...
.  This power structure was extended to orbifolds in \cite{}, and so the missing piece is an analogous result to Ellingsrud-Str\o mme for the local models of orbifold surfaces, namely $\C^2/G$ for $G$ a finite group.  

\subsubsection{Corollaries and extensions of G\o ttsche}
We will also investigate orbifold analogs of several results closely related to G\o ttsche's formula.

First, G\o ttsche observed the following easy corollary to his formula:
\begin{corollary}  Suppose $S$ is connected.
Then for fixed $k$ and large $n$, $b_{k}(S^{[n]})$ stabilizes
\end{corollary}

The point is that there is exactly one factor in the product formula that has no $t$'s, namely $1/(1-q)$.  If we remove this term, we may expand the product as a series in $t$ with coefficients polynomials in $q$.

Grojnowski and Nakajima gave another proof by categorifying G\"ottsche's formula.  The power series on the right hand side is the $(q,t)$ character of the highest weight representation of the Heisenberg algebra modeled on $H^*(S)$.  Thus, one is lead to hope that the vector space 
$$\mathcal{H}_S=\bigoplus_{k\geq 0} H^k(S)$$
can naturally be given an action of this Heisenberg algebra.  This is exactly what Grojnowski and Nakajima did, using nested Hilbert schemes of points.

In case the quasiprojective surface $S$ is the minimal resolution of the ADE singularity, this Heisenberg action is part of a quantumn group action for the corresponding semisimple quantum group.




That is, we look for 
$$\DC_G(q,t):=\sum_{n,k\geq 0 } b_k(\Hilb_n([\C^2/G])) t^kq^n$$





\subsection{Conjectural product formula}

To state our conjectural formula, we will use the Pochhammer symbol $(a;x)_\infty:=\prod_{\ell\geq 0} (1-ax^\ell)$.
\begin{example}
Using the Pochhammer symbol, G\o ttsche's formula becomes:
$$\sum_{n\geq 0} b_k(\Hilb_n(S))t^kq^n=
\frac{(-qt;qt^2)_\infty^{b_1}(-qt^3;qt^2)_\infty^{b_3}}{(q;qt^2)_\infty^{b_0}}\frac{1}{(qt^2;qt^2)_\infty^{b_2}}\frac{1}{(qt^4;qt^2)_\infty^{b_4}}$$
\end{example}

In \cite{GLMequivariant}, we have the following conjectural product formula 
{Conjecture (Gusein-Zade, Luengo, Melle-Hern\'andez)}

$$\DC_{1/3}=\frac{1}{(q;t^2q^3)_\infty}\frac{1}{(q^2t^2;t^2q^3)_\infty}\frac{1}{(q^3;t^2q^3)_\infty}$$

Setting $t=1$ should just give the partition function; indeed, we see that this is just the Euler product expansion with some factors of $t$ inserted, with the power of $t$ multiplying $q^n$ depends on $n$ mod 3:

$$\DC_{1/3}=\frac{1}{(1-q)}\frac{1}{(1-qt^2)}\frac{1}{(1-q^3)}\frac{1}{(1-q^4t^2)}
\frac{1}{(1-q^5t^4)}\frac{1}{(1-q^6t^2)}\cdots$$

 It seems in general that if $G\cap SL_2=\{1\}$ then
$$\DC_{G}=\prod_{h=1}^r \frac{1}{(q^h t^{\epsilon(h)}; q^r t^2)_\infty}$$
with $\epsilon(h)$ either 2 or 0; the question is then to describe $\epsilon(h)$.

In G\"ottsche's formula, $\epsilon(h)=0$ corresponds to $b_0$, and $\epsilon(h)=2$ corresponds to $b_2$, and so we might hope for a description of the $\epsilon(h)$ in terms of the cohomology of the stack $[\C^2/G]$.  That is exactly what we propose, using Chen-Ruan cohomology.



\subsection{Chen-Ruan cohomology}

The Chen-Ruan cohomology $H_{CR}^*(\mathcal{X})$ of an orbifold $\mathcal{X}$ was discovered as a byproduct of defining the quantum cohomology of such orbifolds.  As a vector space, the Chen-Ruan cohomology is the usual cohomology of the inertial orbifold $\mathcal{IX}$ of $\mathcal{X}$.  As a set $\mathcal{IX}$ is the space of constant maps from $S^1$ to $\mathcal{X}$; more algebraically, 
$$\mathcal{IX}=\{(x, (g)| x\in \mathcal{X}, (g)\in\textrm{conj}(G_x)\}$$
Every isotropy group $G_x$ has an identity element $e_x$, the subset of $(x, e_x)$ naturally forms a copy of $X$.  Elements $(x,(g))$ with $(g)$ nontrivial form other components of $\mathcal{IX}$ called \emph{twisted sectors}.

Thus, for $\mathcal{X}=[\C^2/G]$, we see that 
$$H_{CR}^*(\mathcal{X}) =H^*(\mathcal{IX})=\oplus_{g\in\textrm{conj}(G)} (\C^2)^g$$
has a basis indexed by conjugacy classes of $G$.

However, Chen-Ruan cohomology has a different product and grading than $H^*(\mathcal{IX})$.  Each twisted sector has a a degree shifting number $\iota(g)$, obtained as follows.

Since $g\in G_x$, and $g$ acts on $T_x$.  It acts trivially on the tangent directions to fix($g$), and nontrivial on the normal directions.  Diagonalizing the action on the normal bundle, we see that $g$ is a diagonal matrix with entries 
$$(\exp(2\pi i a_1/r), \exp(2\pi i a_2/r), \cdots \exp(2\pi i a_m))$$
Then $\iota(g)=\sum a_i/r$; sometimes called the logarithmic trace of $g$.

The grading shift number is in general only a rational number -- $\iota(g)\in \Z$ if and only if the determinant of $g$ is trivial.  Thus, in case all isotropy groups $G_x$ are in $SL_2$, then the Chen-Ruan cohomology is integrally graded.

\begin{example}

\end{example}


The Chen-Ruan cohomology of $[\C^2/G]$ is rationally graded, with $d$ with $0\leq d < 4$;


$$0\to G\cap SL_2\to G \to \C^*$$








Our conjectural product formula for $\DC_Gy$ is easiest to state in case $G\cap SL_2=1$.  In this case, the action of $G$ on $\wedge T^*\C^2$ is faithful; taking $r$ times the logarithmic trace of this action gives a bijection between $G$ and $\{0,\dots, r-1\}$.


Let $F(g)$ and $I(g)$ denote the fractional and integral parts of $\iota(g)$. 

If $G\cap SL_2=\{1\}$, then $F(G)$ gives a bijection between $G$ and $\{0, 1/r,\dots, (r-1)/r\}$.
\begin{conjecture}[Johnson]
Let $G$ be cyclic, and define $k=|G\cap SL_2|$

$$\mathcal{H}_G(q,t)= \frac{(q^k;q^k)^k_\infty}{(q,q)_\infty} \prod_{g\in G}\frac{1}{(q^{r(1-F(g))} t^{2I(g)},q^rt^2)_\infty}$$

\end{conjecture}







\subsubsection{Homological stability}

The analogs of stabilization and geometric representation theory work on the level of connected Hilbert scheme.

\begin{theorem} 
$P_t(\Hilb^{\delta+nG}_G)$ stabilizes to $1/(t,t)_\infty^{|G|}$
\end{theorem}
Note that the right hand side is independent of $m$ and $\delta$.
\begin{proof} Combinatorics -- a generalization of cores and quotients of partitions \end{proof}

\begin{conjecture}
The stable cohomology of $\Hilb^{\delta+nG}$ is freely generated by the Chern classes of the $|G|$ tautological bundles.
\end{conjecture}



\subsubsection{Heisenberg Action}


\begin{conjecture}
Let $\delta\in K_0(G)$ be small, and $G$ cyclic.  Then
$$\bigoplus_{k\geq 0} H_*(\Hilb^{\delta+kG}_G)$$ admits the action of a Heisenberg algebra based on the cohomology of the minimal resolution of $\C^2/G$.
\end{conjecture}

Evidence:
Let $c$ be the number of rational curves in the minimal resolution of $\C^2/G$.  Then
$$\mathcal{CH}^\delta_G\cdot(q,qt^2)_\infty\cdot (qt^2,qt^2)_\infty^c$$
has positive coefficients; but higher powers start giving negative coefficients.


\subsubsection{Resolutions of $(\C^2/G)^n/S_n$}
One family of resolutions

Let $X_G$ be the minimal resolution of $\C^2/G$.  Then $\Hilb_n(X_G)$ is a resolution of $(\C^2/G)^n/S_n$.


Another family of resolutions

Let $\delta\in K^0(G)$ be such that $\Hilb^\delta([\C^2/G])=pt$.  Then $\Hilb^{\delta+nG}([\C^2/G])$ is a resolution of $(\C^2/G)^n/S_n$.  



Stabilization implies that for fixed $\delta$, and large $n$, this second resolution will be bigger than the first resolution.

Changing Stability?
But, it seems as $\delta\to\infty$, this second family of resolutions converges to the first.



\bibliographystyle{plain}
\bibliography{GHilb}

\end{document}
